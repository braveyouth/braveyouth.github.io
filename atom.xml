<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>奔跑的阳光</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-07-29T00:45:16.454Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>zhangy 保留所有权利</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>docx4使用方案</title>
    <link href="http://yoursite.com/2021/07/09/docx4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88/"/>
    <id>http://yoursite.com/2021/07/09/docx4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88/</id>
    <published>2021-07-09T12:28:29.000Z</published>
    <updated>2021-07-29T00:45:16.454Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>docx4j 是一个开源（ASLv2）Java 库，<strong>用于创建和处理 Microsoft Open XML（Word docx，Powerpoint pptx 和 Excel xlsx）文件</strong>。</p><p>docx4j 官网：<a href="https://www.docx4java.org/trac/docx4j" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a>                                                                                       </p><p>docx4j 示例代码 ：<a href="https://github.com/plutext/docx4j" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a></p><a id="more"></a><h1 id="二、理解docx文件"><a href="#二、理解docx文件" class="headerlink" title="二、理解docx文件"></a>二、理解docx文件</h1><h2 id="1-认识-Open-XML"><a href="#1-认识-Open-XML" class="headerlink" title="1.认识 Open XML"></a>1.认识 <strong>Open XML</strong></h2><p>docx4j 主要是针对 docx 文件进行操作，操作的对象的 <strong>Microsoft Open XML 文件。</strong></p><p>Office Open XML，也称为 OpenXML 或 OOXML，是 Office 文档的基础 XML 的格式，应用于 word，execl，ppt，图表等。该规范由 Microsoft 开发，被 ISO 和 IEC 采纳。现在是所有 Microsoft Office 文档（.docx，.xlsx 和. pptx）的默认格式。</p><p>Microsoft Open XML官网：<a href="http://officeopenxml.com/anatomyofOOXML" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a> </p><h2 id="2-docx-文件的结构"><a href="#2-docx-文件的结构" class="headerlink" title="2.docx 文件的结构"></a>2.docx 文件的结构</h2><p>docx 我们可以理解为一个前端项目的压缩包，里面有样式文件，dom 格式的 xml 文件，我们解压一个 docx 的文件看一下它的目录结构：</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/docx4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88/up-32246fe8bfe87773aadb8848c378bf9e3b8.png" alt="排序算法分类"></p><p>我们先看根目录下的 [Content_Types] .xml 文件，这个是整个 docx 文件的内容组件的配置文件，整个压缩包中用到的文件都在里面配置，可以简单理解为，我们写前端时 html 文件的 head 部分关于 js,css 引用的部分，但这样理解有点不明确，想象一下，jsp 文件 include 各部分的总页面，有点类似。</p><p>_rels 这个目录是配置定义各部分间的关系，了解就行，</p><p>看里面的<strong>核心 word 目录</strong>，可以看到，这个目录结构跟我们前端项目的 html、css 结构很相似，</p><p>media 目录下放多媒体元素，图片之类的，了解就行</p><p>theme 目录，顾名思义，word 的主题，了解就行</p><p>word 目录下最重要的是里面的 <strong>document.xml</strong> 文件</p><p>其他的 word 部分文件，settings.xml 和 styles.xml 是 docx 文件都有的配置和样式文件，footTable 是字体表，footnotes 是词汇表，其他的还有 foot 开头的脚表，head 开头的是页眉文件之类的文件</p><h2 id="3-docx-的核心-OpenXML-文件格式"><a href="#3-docx-的核心-OpenXML-文件格式" class="headerlink" title="3.docx 的核心 OpenXML 文件格式"></a>3.docx 的核心 OpenXML 文件格式</h2><p>我们主要看 <strong>document.xml</strong> 文件，这个文件是整个 docx 的骨架，类似于前端页面的 html 文件，是最基础、也是最重要的文件。</p><p>理解 <strong>document.xml</strong> 的文本结构，这个文本结构类似 html 格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; standalone&#x3D;&quot;yes&quot;?&gt;</span><br><span class="line">&lt;w:document&gt;</span><br><span class="line">    &lt;w:body&gt;</span><br><span class="line">        &lt;w:p&gt;&lt;&#x2F;w:p&gt;</span><br><span class="line">        &lt;w:tbl&gt;&lt;&#x2F;w:tbl&gt;</span><br><span class="line">        &lt;w:sectPr&gt;&lt;&#x2F;w:sectPr&gt;</span><br><span class="line">    &lt;&#x2F;w:body&gt;</span><br><span class="line">&lt;&#x2F;w:document&gt;</span><br></pre></td></tr></table></figure><h1 id="三、使用docx4j"><a href="#三、使用docx4j" class="headerlink" title="三、使用docx4j"></a>三、使用docx4j</h1><h2 id="1-maven-导入"><a href="#1-maven-导入" class="headerlink" title="1.maven 导入"></a>1.maven 导入</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.docx4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>docx4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-简单使用"><a href="#2-简单使用" class="headerlink" title="2.简单使用"></a>2.简单使用</h2><h3 id="2-1-基础创建"><a href="#2-1-基础创建" class="headerlink" title="2.1 基础创建"></a>2.1 基础创建</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 基础创建:创建一个新的docx文档</span></span><br><span class="line"><span class="comment">     * 获取文档可操作对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/createDocx"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">createDocx</span><span class="params">(HttpServletResponse response)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(template01Path)) &#123;</span><br><span class="line">            OutputStream outs = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                wordMLPackage =  WordprocessingMLPackage.createPackage();</span><br><span class="line"><span class="comment">//                wordMLPackage.save(new File(template01Path));</span></span><br><span class="line"><span class="comment">//                Docx4J.save(wordMLPackage, new File(docxPath));</span></span><br><span class="line">                String fileName = URLEncoder.encode(<span class="string">"模板表"</span>, <span class="string">"UTF-8"</span>);</span><br><span class="line">                response.setContentType(<span class="string">"application/octet-stream;charset=UTF-8"</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">                response.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment; filename="</span> + fileName + <span class="string">".docx"</span>);</span><br><span class="line">                response.setHeader(<span class="string">"Access-Control-Expose-Headers"</span>, <span class="string">"Content-Disposition"</span>);</span><br><span class="line"></span><br><span class="line">                outs = response.getOutputStream();</span><br><span class="line">                wordMLPackage.save(outs);</span><br><span class="line">                outs.flush();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.error(e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"路径不存在"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"基础创建成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-追加文档内容"><a href="#2-2-追加文档内容" class="headerlink" title="2.2 追加文档内容"></a>2.2 追加文档内容</h3><h4 id="2-2-1-向文件中增加段落"><a href="#2-2-1-向文件中增加段落" class="headerlink" title="2.2.1 向文件中增加段落"></a>2.2.1 向文件中增加段落</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 追加文档内容</span></span><br><span class="line"><span class="comment">     * 向文档中追加内容(默认支持中文)</span></span><br><span class="line"><span class="comment">     * 先清空,再生成,防重复</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/addParagraph"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addParagraph</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//先加载word文档</span></span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line"><span class="comment">//            wordMLPackage = Docx4J.load(new File(docxPath));</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//增加内容</span></span><br><span class="line">            wordMLPackage.getMainDocumentPart().addParagraphOfText(<span class="string">"你好!"</span>);</span><br><span class="line">            wordMLPackage.getMainDocumentPart().addStyledParagraphOfText(<span class="string">"Title"</span>, <span class="string">"这是标题!"</span>);</span><br><span class="line">            wordMLPackage.getMainDocumentPart().addStyledParagraphOfText(<span class="string">"Subtitle"</span>, <span class="string">" 这是二级标题!"</span>);</span><br><span class="line"></span><br><span class="line">            wordMLPackage.getMainDocumentPart().addStyledParagraphOfText(<span class="string">"Subject"</span>, <span class="string">"试一试"</span>);</span><br><span class="line">            <span class="comment">//保存文档</span></span><br><span class="line">            wordMLPackage.save(<span class="keyword">new</span> File(template01OutPath));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Docx4JException e) &#123;</span><br><span class="line">            logger.error(<span class="string">"addParagraph to docx error: Docx4JException"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"追加文档内容成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-2-采用工厂类增加段落的方法-工厂类的使用，工厂类也是一种通用的方法"><a href="#2-2-2-采用工厂类增加段落的方法-工厂类的使用，工厂类也是一种通用的方法" class="headerlink" title="2.2.2 采用工厂类增加段落的方法(工厂类的使用，工厂类也是一种通用的方法)"></a>2.2.2 采用工厂类增加段落的方法(工厂类的使用，工厂类也是一种通用的方法)</h4><p>先创建一个工厂，（需要导入的包是org.docx4j.wml，导错的的话下面全错）。</p><p>R是一个运行块，负责便于将多个属性相同的Object对象统一操作，通过其内部的content成员变量可以添加内容，RPr是运行块的属性(属于类R的一个成员变量)，可以对R对象进行操作。R通过被作为其他对象的content内容。所以通过R在A元素中加一个B元素的操作的一般步骤是:(1)创建R;(2)将内容元素B加到R中;(3)将R增加到A元素中;(4)将A元素加到mainDocumentPart内容中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 增加一个段落，增加完成记得保存，否则不生效</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/addParagraph2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addParagraph2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String simpleText = <span class="string">"addParagraph2"</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage</span><br><span class="line">                    .load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            factory = Context.getWmlObjectFactory();</span><br><span class="line">            P para = factory.createP();</span><br><span class="line">            <span class="keyword">if</span> (simpleText != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Text t = factory.createText();</span><br><span class="line">                t.setValue(simpleText);</span><br><span class="line">                R run = factory.createR();</span><br><span class="line">                run.getContent().add(t);</span><br><span class="line">                para.getContent().add(run);</span><br><span class="line">            &#125;</span><br><span class="line">            wordMLPackage.getMainDocumentPart().getContent().add(para);</span><br><span class="line">            wordMLPackage.save(<span class="keyword">new</span> File(template01OutPath));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(<span class="string">"addParagraph to docx error: Docx4JException"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"追加文档内容成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-图片"><a href="#2-3-图片" class="headerlink" title="2.3 图片"></a>2.3 图片</h3><h4 id="2-3-1-图片工具类"><a href="#2-3-1-图片工具类" class="headerlink" title="2.3.1 图片工具类"></a>2.3.1 图片工具类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DocImageHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将图片加入到包中</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> wordMLPackage</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addImageToPackage</span><span class="params">(WordprocessingMLPackage wordMLPackage, <span class="keyword">byte</span>[] bytes)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BinaryPartAbstractImage imagePart = BinaryPartAbstractImage.createImagePart(wordMLPackage, bytes);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> docPrId = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> cNvPrId = <span class="number">2</span>;</span><br><span class="line">        Inline inline = imagePart.createImageInline(<span class="string">"Filename hint"</span>,</span><br><span class="line">                <span class="string">"Alternative text"</span>, docPrId, cNvPrId, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        P paragraph = addInlineImageToParagraph(inline);</span><br><span class="line"></span><br><span class="line">        wordMLPackage.getMainDocumentPart().addObject(paragraph);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将图片加入到 段落中去</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inline</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> P <span class="title">addInlineImageToParagraph</span><span class="params">(Inline inline)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 添加内联对象到一个段落中</span></span><br><span class="line">        ObjectFactory factory = <span class="keyword">new</span> ObjectFactory();</span><br><span class="line">        P paragraph = factory.createP();</span><br><span class="line">        R run = factory.createR();</span><br><span class="line">        paragraph.getContent().add(run);</span><br><span class="line">        Drawing drawing = factory.createDrawing();</span><br><span class="line">        run.getContent().add(drawing);</span><br><span class="line">        drawing.getAnchorOrInline().add(inline);</span><br><span class="line">        <span class="keyword">return</span> paragraph;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将图片从文件对象转换为字节数组</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file 将要转换的文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 包含图片字节数据的字节数组</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] convertImageToByteArray(File file) <span class="keyword">throws</span> FileNotFoundException, IOException &#123;</span><br><span class="line">        InputStream is = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">        <span class="keyword">long</span> length = file.length();</span><br><span class="line">        <span class="comment">// 不能使用long类型创建数组, 需要用int类型.</span></span><br><span class="line">        <span class="keyword">if</span> (length &gt; Integer.MAX_VALUE) &#123;</span><br><span class="line">            System.out.println(<span class="string">"File too large!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[(<span class="keyword">int</span>) length];</span><br><span class="line">        <span class="keyword">int</span> offset = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> numRead = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (offset &lt; bytes.length &amp;&amp; (numRead = is.read(bytes, offset, bytes.length - offset)) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            offset += numRead;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 确认所有的字节都没读取</span></span><br><span class="line">        <span class="keyword">if</span> (offset &lt; bytes.length) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Could not completely read file "</span> + file.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        is.close();</span><br><span class="line">        <span class="keyword">return</span> bytes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-3-2-插入图片"><a href="#2-3-2-插入图片" class="headerlink" title="2.3.2 插入图片"></a>2.3.2 插入图片</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入图片</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/wordInsertImage"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">wordInsertImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(docxPath));</span><br><span class="line">            <span class="keyword">byte</span>[] bytes = DocImageHandler.convertImageToByteArray(<span class="keyword">new</span> File(picPath));</span><br><span class="line">            DocImageHandler.addImageToPackage(wordMLPackage, bytes);</span><br><span class="line">            wordMLPackage.save(<span class="keyword">new</span> File(docxOutPath));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"插入图片成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-创建表格"><a href="#2-4-创建表格" class="headerlink" title="2.4 创建表格"></a>2.4 创建表格</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建表格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"addTable"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            MainDocumentPart mainDocumentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line"></span><br><span class="line">            factory = Context.getWmlObjectFactory();</span><br><span class="line">            <span class="comment">// 1 创建表格元素</span></span><br><span class="line">            Tbl table = factory.createTbl();</span><br><span class="line">            <span class="comment">//2 显示表格的边框</span></span><br><span class="line">            addBorders(table);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3 添加表格内容(创建行和列)</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                Tr tr = factory.createTr();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                    Tc tc = factory.createTc();</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//3.1 查看createParagraphOfText(str)的源码</span></span><br><span class="line">                    <span class="comment">// 3.1.1.创建一个text，并设置其值，</span></span><br><span class="line">                    <span class="comment">// 3.1.2.创建一个R并将text增加到R中，</span></span><br><span class="line">                    <span class="comment">// 3.1.3.创建一个P将R加到P中</span></span><br><span class="line"><span class="comment">//                    P p = mainDocumentPart.createParagraphOfText("---row" + i + "---column" + j + "---");</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//3.2 第二种创建P并设置样式的方法</span></span><br><span class="line">                    P p = factory.createP();</span><br><span class="line">                    R r = factory.createR();</span><br><span class="line">                    Text text = factory.createText();</span><br><span class="line">                    text.setValue(<span class="string">"---row"</span> + i + <span class="string">"---column"</span> + j + <span class="string">"---"</span>);</span><br><span class="line">                    r.getContent().add(text);</span><br><span class="line">                    p.getContent().add(r);</span><br><span class="line">                    <span class="comment">//3.2.1 通过R设置字体加粗等属性</span></span><br><span class="line">                    setRStyle(r);</span><br><span class="line">                    <span class="comment">//3.2.2 设置列宽</span></span><br><span class="line">                    <span class="keyword">if</span> (j == <span class="number">1</span>) &#123;</span><br><span class="line">                        setCellWidth(tc, <span class="number">1250</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        setCellWidth(tc, <span class="number">2500</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    tc.getContent().add(p);</span><br><span class="line">                    tr.getContent().add(tc);</span><br><span class="line">                &#125;</span><br><span class="line">                table.getContent().add(tr);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4 将新增表格加到主要内容中</span></span><br><span class="line">            mainDocumentPart.addObject(table);</span><br><span class="line">            wordMLPackage.save(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Docx4JException e) &#123;</span><br><span class="line">            logger.error(<span class="string">"createDocx error: Docx4JException"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"创建表格成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置边框样式</span></span><br><span class="line"><span class="comment">     * 需要设置表格边框的单元格</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> table</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addBorders</span><span class="params">(Tbl table)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 必须设置一个TblPr，否则最后会报空指针异常</span></span><br><span class="line">        table.setTblPr(<span class="keyword">new</span> TblPr());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建一个默认颜色（黑色）、粗细尺寸为4、间距为0的单线边框的边框组件（Border component）</span></span><br><span class="line">        CTBorder border = <span class="keyword">new</span> CTBorder();</span><br><span class="line">        border.setColor(<span class="string">"auto"</span>);</span><br><span class="line">        border.setSz(<span class="keyword">new</span> BigInteger(<span class="string">"4"</span>));</span><br><span class="line">        border.setSpace(<span class="keyword">new</span> BigInteger(<span class="string">"0"</span>));</span><br><span class="line">        border.setVal(STBorder.SINGLE);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 边框组件被应用到表格的四周以及表格内部水平和垂直的边框</span></span><br><span class="line">        TblBorders borders = <span class="keyword">new</span> TblBorders();</span><br><span class="line">        borders.setBottom(border);</span><br><span class="line">        borders.setLeft(border);</span><br><span class="line">        borders.setRight(border);</span><br><span class="line">        borders.setTop(border);</span><br><span class="line">        borders.setInsideH(border);</span><br><span class="line">        borders.setInsideV(border);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取其内部的TblPr属性设置属性,边框应用到表格</span></span><br><span class="line">        table.getTblPr().setTblBorders(borders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过设置R设置表格中属性字体加粗，大小为25</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setRStyle</span><span class="params">(R r)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1.创建一个RPr</span></span><br><span class="line">        RPr rpr = <span class="keyword">new</span> RPr();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.设置RPr</span></span><br><span class="line">        <span class="comment">// 2.1设置字体大小</span></span><br><span class="line">        HpsMeasure size = <span class="keyword">new</span> HpsMeasure();</span><br><span class="line">        size.setVal(<span class="keyword">new</span> BigInteger(<span class="string">"25"</span>));</span><br><span class="line">        rpr.setSz(size);</span><br><span class="line">        <span class="comment">// 2.2设置加粗</span></span><br><span class="line">        BooleanDefaultTrue bold = <span class="keyword">new</span> BooleanDefaultTrue();</span><br><span class="line">        bold.setVal(<span class="keyword">true</span>);</span><br><span class="line">        rpr.setB(bold);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.将RPr设置为R的属性</span></span><br><span class="line">        r.setRPr(rpr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置列宽</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tc</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> width</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setCellWidth</span><span class="params">(Tc tc, <span class="keyword">int</span> width)</span> </span>&#123;</span><br><span class="line">        TcPr tableCellProperties = <span class="keyword">new</span> TcPr();</span><br><span class="line">        TblWidth tableWidth = <span class="keyword">new</span> TblWidth();</span><br><span class="line">        tableWidth.setW(BigInteger.valueOf(width));</span><br><span class="line">        tableCellProperties.setTcW(tableWidth);</span><br><span class="line"></span><br><span class="line">        tc.setTcPr(tableCellProperties);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>补充：</p><ul><li><p>工厂类的一些通用方法 </p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/docx4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88/docx4j%E5%B7%A5%E5%8E%82%E7%B1%BB%E6%96%B9%E6%B3%95.png" alt=""></p></li><li><p>格式化样式的操作</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/docx4%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88/docx4j%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.png" alt=""></p></li></ul><h3 id="2-5-读取表格内容-解析docx4j的树结构—获取指定类型的元素"><a href="#2-5-读取表格内容-解析docx4j的树结构—获取指定类型的元素" class="headerlink" title="2.5 读取表格内容(解析docx4j的树结构—获取指定类型的元素)"></a>2.5 读取表格内容(解析docx4j的树结构—获取指定类型的元素)</h3><p>有时候我们调用getContent()获取的元素类型是Tr之类的直接元素，可以强转;有时候不可以直接强转，其类型是JAXBElement，需要进行提取—getAllElementFromObject方法 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取表格内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"readTable"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readTable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 1. ClassFinder构造类型查询器获取指定元素</span></span><br><span class="line">            ClassFinder find = <span class="keyword">new</span> ClassFinder(Tbl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">new</span> TraversalUtil(documentPart.getContent(), find);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取到第一个表格元素</span></span><br><span class="line">            Tbl table = (Tbl) find.results.get(<span class="number">0</span>);</span><br><span class="line">            List&lt;Object&gt; trs = table.getContent();</span><br><span class="line">            logger.info(<span class="string">"&#123;&#125;"</span>, trs);</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"====================="</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (Object obj : trs) &#123;</span><br><span class="line">                Tr tr = (Tr) obj;<span class="comment">// 获取到tr</span></span><br><span class="line">                List&lt;Object&gt; content = tr.getContent();</span><br><span class="line">                logger.info(<span class="string">"&#123;&#125;"</span>, content);</span><br><span class="line">                List&lt;Object&gt; objList = getAllElementFromObject(tr, Tc<span class="class">.<span class="keyword">class</span>)</span>;<span class="comment">// 获取所有的Tc元素</span></span><br><span class="line">                <span class="keyword">for</span> (Object obj1 : objList) &#123;</span><br><span class="line">                    Tc tc = (Tc) obj1;</span><br><span class="line">                    logger.info(<span class="string">"&#123;&#125;"</span>, tc.getContent());</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">"==============="</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Docx4JException e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"读取表格内容"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Object&gt; <span class="title">getAllElementFromObject</span><span class="params">(Object obj, Class&lt;?&gt; toSearch)</span> </span>&#123;</span><br><span class="line">        List&lt;Object&gt; result = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">        <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> JAXBElement)</span><br><span class="line">            obj = ((JAXBElement&lt;?&gt;) obj).getValue();</span><br><span class="line">        <span class="keyword">if</span> (obj.getClass().equals(toSearch))</span><br><span class="line">            result.add(obj);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> ContentAccessor) &#123;</span><br><span class="line">            List&lt;?&gt; children = ((ContentAccessor) obj).getContent();</span><br><span class="line">            <span class="keyword">for</span> (Object child : children) &#123;</span><br><span class="line">                result.addAll(getAllElementFromObject(child, toSearch));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-6-读取docx文件"><a href="#2-6-读取docx文件" class="headerlink" title="2.6 读取docx文件"></a>2.6 读取docx文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 读取docx文件(这里不支持doc文件)</span></span><br><span class="line"><span class="comment">    * 读取word文件，这里没有区分 word中的样式格式</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@GetMapping</span>(<span class="string">"readParagraph"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">readParagraph</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       List&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line"></span><br><span class="line">           String contentType = wordMLPackage.getContentType();</span><br><span class="line">           logger.info(<span class="string">"contentType:"</span>+contentType);</span><br><span class="line">           MainDocumentPart part = wordMLPackage.getMainDocumentPart();</span><br><span class="line">           logger.info(<span class="string">"content -&gt; body -&gt; "</span>+part.getContents().getBody().toString());</span><br><span class="line">           list = part.getContent();</span><br><span class="line">           <span class="keyword">for</span>(Object o :list) &#123;</span><br><span class="line">               logger.info(<span class="string">"info:"</span>+o);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">           logger.error(e.getMessage());</span><br><span class="line">       &#125;</span><br><span class="line">       String jsonString = JSON.toJSONString(list);</span><br><span class="line">       <span class="keyword">return</span> jsonString;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="2-7-docx转html文件"><a href="#2-7-docx转html文件" class="headerlink" title="2.7 docx转html文件"></a>2.7 docx转html文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * docx转html文件</span></span><br><span class="line"><span class="comment">     * 样式表可以自行修改</span></span><br><span class="line"><span class="comment">     * 转xls,再转html</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/wordToHtml"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">wordToHtml</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> nestLists = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">boolean</span> save = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            HTMLSettings html = Docx4J.createHTMLSettings();</span><br><span class="line">            <span class="comment">//设置图片的目录地址</span></span><br><span class="line">            html.setImageDirPath(template01Path + <span class="string">"_files"</span>);</span><br><span class="line">            html.setImageTargetUri(template01Path.substring(template01Path.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span> ) + <span class="string">"_files"</span>);</span><br><span class="line">            html.setWmlPackage(wordMLPackage);</span><br><span class="line">            String userCSS = <span class="keyword">null</span>;</span><br><span class="line">            <span class="comment">//userCSS是生成的html的样式，可以手动设置，使用此参数可以灵活的设置边距字体等信息</span></span><br><span class="line">            <span class="keyword">if</span> (nestLists) &#123;</span><br><span class="line">                userCSS = <span class="string">"html, body, div, span, h1, h2, h3, h4, h5, h6, p, a, img,  table, caption, tbody, tfoot, thead, tr, th, td "</span></span><br><span class="line">                        + <span class="string">"&#123; margin: 0; padding: 0; border: 0;&#125;"</span> + <span class="string">"body &#123;line-height: 1;&#125; "</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                userCSS = <span class="string">"html, body, div, span, h1, h2, h3, h4, h5, h6, p, a, img,  ol, ul, li, table, caption, tbody, tfoot, thead, tr, th, td "</span></span><br><span class="line">                        + <span class="string">"&#123; margin: 0; padding: 0; border: 0;&#125;"</span> + <span class="string">"body &#123;line-height: 1;&#125; "</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            html.setUserCSS(userCSS);</span><br><span class="line">            OutputStream os = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (save) &#123;</span><br><span class="line">                os = <span class="keyword">new</span> FileOutputStream(template01Path + <span class="string">".html"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                os = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//设置输出</span></span><br><span class="line">            Docx4jProperties.setProperty(<span class="string">"docx4j.Convert.Out.HTML.OutputMethodXML"</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            Docx4J.toHTML(html, os, Docx4J.FLAG_EXPORT_PREFER_XSL);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (save) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Saved: "</span> + template01Path + <span class="string">".html "</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(((ByteArrayOutputStream) os).toString());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (wordMLPackage.getMainDocumentPart().getFontTablePart() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                wordMLPackage.getMainDocumentPart().getFontTablePart().deleteEmbeddedFontTempFiles();</span><br><span class="line">            &#125;</span><br><span class="line">            html = <span class="keyword">null</span>;</span><br><span class="line">            wordMLPackage = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"docx转html文件成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-8-按指定变量替换docx中的内容-var-替换"><a href="#2-8-按指定变量替换docx中的内容-var-替换" class="headerlink" title="2.8 按指定变量替换docx中的内容  ${var}替换"></a>2.8 按指定变量替换docx中的内容  ${var}替换</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 按指定变量替换docx中的内容  $&#123;var&#125;替换</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"replaceTableByVariable"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceTableByVariable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> save = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            VariablePrepare.prepare(wordMLPackage);</span><br><span class="line">            MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line">            Docx4jUtil.cleanDocumentPart(documentPart);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//需要替换的map</span></span><br><span class="line">            HashMap&lt;String, String&gt; mappings = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">            mappings.put(<span class="string">"name"</span>, <span class="string">"张三"</span>);</span><br><span class="line">            mappings.put(<span class="string">"age"</span>, <span class="string">"25"</span>);</span><br><span class="line">            mappings.put(<span class="string">"sex"</span>, <span class="string">"男"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">            documentPart.variableReplace(mappings);</span><br><span class="line"><span class="comment">//            // unmarshallFromTemplate requires string input</span></span><br><span class="line"><span class="comment">//            String xml = XmlUtils.marshaltoString(documentPart.getJaxbElement(), true);</span></span><br><span class="line"><span class="comment">//            // Do it...</span></span><br><span class="line"><span class="comment">//            Object obj = XmlUtils.unmarshallFromTemplate(xml, mappings);</span></span><br><span class="line"><span class="comment">//            // Inject result into docx</span></span><br><span class="line"><span class="comment">//            documentPart.setJaxbElement((Document) obj);</span></span><br><span class="line">            <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">            <span class="keyword">long</span> total = end - start;</span><br><span class="line">            logger.info(<span class="string">"Time: "</span> + total);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Save it</span></span><br><span class="line">            <span class="keyword">if</span> (save) &#123;</span><br><span class="line">                <span class="comment">// 输出word文件</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//1</span></span><br><span class="line"><span class="comment">//                SaveToZipFile saver = new SaveToZipFile(wordMLPackage);</span></span><br><span class="line"><span class="comment">//                saver.save("/home/person-project/helloworld_1.docx");</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//2</span></span><br><span class="line"><span class="comment">//                OutputStream outputStream = new FileOutputStream(new File(docxOutPath));</span></span><br><span class="line"><span class="comment">//                wordMLPackage.save(outputStream);</span></span><br><span class="line"><span class="comment">//                outputStream.flush();</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//3</span></span><br><span class="line"><span class="comment">//                wordMLPackage.save(new File(docxOutPath));</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//4</span></span><br><span class="line">                Docx4J.save(wordMLPackage, <span class="keyword">new</span> File(template01OutPath));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                logger.info(XmlUtils.marshaltoString(documentPart.getJaxbElement(), <span class="keyword">true</span>, <span class="keyword">true</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"按指定变量替换docx中的内容成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-9-替换模板里面的表格-循环替换标签"><a href="#2-9-替换模板里面的表格-循环替换标签" class="headerlink" title="2.9 替换模板里面的表格(循环替换标签)"></a>2.9 替换模板里面的表格(循环替换标签)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 替换模板里面的表格(循环替换标签)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"replaceTableByLoop"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceTableByLoop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        factory = Context.getWmlObjectFactory();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template01Path));</span><br><span class="line">            MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line">            Docx4jUtil.cleanDocumentPart(documentPart);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 构造循环列表的数据</span></span><br><span class="line">            ClassFinder find = <span class="keyword">new</span> ClassFinder(Tbl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">new</span> TraversalUtil(documentPart.getContent(), find);</span><br><span class="line">            <span class="comment">// 获取到第一个表格元素</span></span><br><span class="line">            Tbl table = (Tbl) find.results.get(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 第一行约定为模板，获取到第一行内容</span></span><br><span class="line">            Tr dynamicTr = (Tr) table.getContent().get(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 获取模板行的xml数据</span></span><br><span class="line">            String dynamicTrXml = XmlUtils.marshaltoString(dynamicTr);</span><br><span class="line"></span><br><span class="line">            List&lt;Map&lt;String, Object&gt;&gt; dataList = getDataList();</span><br><span class="line">            <span class="keyword">for</span> (Map&lt;String, Object&gt; dataMap : dataList) &#123;</span><br><span class="line">                Tr newTr = (Tr) XmlUtils.unmarshallFromTemplate(dynamicTrXml, dataMap);<span class="comment">// 填充模板行数据</span></span><br><span class="line">                table.getContent().add(newTr);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 删除模板行的占位行</span></span><br><span class="line">            table.getContent().remove(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            Docx4J.save(wordMLPackage, <span class="keyword">new</span> File(template01OutPath));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"替换模板里面的表格成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Map&lt;String, Object&gt;&gt; getDataList() &#123;</span><br><span class="line">        List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">            map.put(<span class="string">"name"</span>, <span class="string">"name"</span> + i);</span><br><span class="line">            map.put(<span class="string">"sex"</span>, <span class="string">"sex"</span> + i);</span><br><span class="line">            map.put(<span class="string">"age"</span>, <span class="string">"age"</span> + i);</span><br><span class="line">            list.add(map);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-10-按占位符替换内容-替换变量、表格等格式数据"><a href="#2-10-按占位符替换内容-替换变量、表格等格式数据" class="headerlink" title="2.10 按占位符替换内容(替换变量、表格等格式数据)"></a>2.10 按占位符替换内容(替换变量、表格等格式数据)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 按占位符替换内容(替换变量、表格等格式数据)</span></span><br><span class="line"><span class="comment">     * 注意：1 占位符在word转换为xml被分离问题：</span></span><br><span class="line"><span class="comment">     * 1.1 原因：</span></span><br><span class="line"><span class="comment">     * 1.1.1 打开word模板，单词底下有红线标注，这个就是word文档的单词校验，一般组装的标识符不符合单词校验规则，在转换的过程中，会单独分开（因为底下有标注），所以就会产生占位符被分开的情况。</span></span><br><span class="line"><span class="comment">     * 1.2 解决方案：</span></span><br><span class="line"><span class="comment">     * 1.2.1 docx中先不写变量，将docx另存为xml，然后用docx打开这个xml，这时候加变量就好了，$&#123;variable&#125;就不会被分离了，之后再另存为docx即可</span></span><br><span class="line"><span class="comment">     * 1.2.2 先建一个txt文本，将$&#123;variable&#125;编辑到文本，然后复制到docx即可(推荐)</span></span><br><span class="line"><span class="comment">     * 1.2.3 调用Docx4jUtil.cleanDocumentPart(MainDocumentPart documentPart)清扫 docx4j 模板变量字符,通常以$&#123;variable&#125;形式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/placeholderTable"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">placeholderTable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(templatePath));</span><br><span class="line">            Map&lt;String, String&gt; mappings = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">            <span class="comment">//构造非循环格子的表格数据</span></span><br><span class="line">            mappings.put(<span class="string">"name"</span>, <span class="string">"马参军"</span>);</span><br><span class="line">            mappings.put(<span class="string">"sex"</span>, <span class="string">"男"</span>);</span><br><span class="line">            mappings.put(<span class="string">"skill"</span>, <span class="string">"散谣：三人成虎事多有"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//构造循环列表的数据</span></span><br><span class="line">            ClassFinder find = <span class="keyword">new</span> ClassFinder(Tbl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">new</span> TraversalUtil(wordMLPackage.getMainDocumentPart().getContent(), find);</span><br><span class="line">            Tbl table = (Tbl) find.results.get(<span class="number">1</span>);</span><br><span class="line">            Tr dynamicTr = (Tr) table.getContent().get(<span class="number">1</span>);<span class="comment">//第二行约定为模板</span></span><br><span class="line">            String dynamicTrXml = XmlUtils.marshaltoString(dynamicTr);<span class="comment">//获取模板行的xml数据</span></span><br><span class="line">            List&lt;Map&lt;String , Object&gt;&gt; dataList = dataList();</span><br><span class="line">            <span class="keyword">for</span> (Map&lt;String, Object&gt; dataMap : dataList) &#123;</span><br><span class="line">                Tr newTr = (Tr) XmlUtils.unmarshallFromTemplate(dynamicTrXml, dataMap);<span class="comment">//填充模板行数据</span></span><br><span class="line">                table.getContent().add(newTr);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//删除模板行的占位行</span></span><br><span class="line">            table.getContent().remove(<span class="number">1</span>);</span><br><span class="line">            wordMLPackage.getMainDocumentPart().variableReplace(mappings);<span class="comment">//设置全局的变量替换</span></span><br><span class="line">            Docx4J.save(wordMLPackage, <span class="keyword">new</span> File(outPath));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"按占位符替换内容成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造循环数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Map&lt;String , Object&gt;&gt; dataList() &#123;</span><br><span class="line">        List&lt;Map&lt;String , Object&gt;&gt; dataList = <span class="keyword">new</span> ArrayList&lt;Map&lt;String , Object&gt;&gt;();</span><br><span class="line">        Map&lt;String , Object&gt; m1 = <span class="keyword">new</span> HashMap&lt;String , Object&gt;();</span><br><span class="line">        m1.put(<span class="string">"number"</span>, <span class="string">"1"</span>);m1.put(<span class="string">"company"</span>, <span class="string">"阿里巴巴"</span>);</span><br><span class="line">        m1.put(<span class="string">"slogan"</span>, <span class="string">"让天下没有难做的生意"</span>);</span><br><span class="line">        dataList.add(m1);</span><br><span class="line">        Map&lt;String , Object&gt; m2 = <span class="keyword">new</span> HashMap&lt;String , Object&gt;();</span><br><span class="line">        m2.put(<span class="string">"number"</span>, <span class="string">"2"</span>);m2.put(<span class="string">"company"</span>, <span class="string">"腾讯"</span>);</span><br><span class="line">        m2.put(<span class="string">"slogan"</span>, <span class="string">"连接你我 共生未来"</span>);</span><br><span class="line">        dataList.add(m2);</span><br><span class="line">        Map&lt;String , Object&gt; m3 = <span class="keyword">new</span> HashMap&lt;String , Object&gt;();</span><br><span class="line">        m3.put(<span class="string">"number"</span>, <span class="string">"3"</span>);m3.put(<span class="string">"company"</span>, <span class="string">"字节跳动"</span>);</span><br><span class="line">        m3.put(<span class="string">"slogan"</span>, <span class="string">"激发创造 丰富生活"</span>);</span><br><span class="line">        dataList.add(m3);</span><br><span class="line">        <span class="keyword">return</span> dataList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-11-按书签替换内容-替换变量、表格、图片等格式数据"><a href="#2-11-按书签替换内容-替换变量、表格、图片等格式数据" class="headerlink" title="2.11 按书签替换内容(替换变量、表格、图片等格式数据)"></a>2.11 按书签替换内容(替换变量、表格、图片等格式数据)</h3><p> 这种方式比基于变量的方式灵活，而且操作简单，我们只用在word中插入书签 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 按书签替换内容(替换变量、表格、图片等格式数据)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/booknameReplaceVar"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">booknameReplaceVar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(<span class="keyword">new</span> File(template02Path));</span><br><span class="line">            MainDocumentPart mainDocumentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line">            factory = Context.getWmlObjectFactory();</span><br><span class="line"></span><br><span class="line">            Document wmlDoc = (Document) mainDocumentPart.getJaxbElement();</span><br><span class="line">            Body body = wmlDoc.getBody();</span><br><span class="line">            <span class="comment">// 提取正文中所有段落</span></span><br><span class="line">            List&lt;Object&gt; paragraphs = body.getContent();</span><br><span class="line">            <span class="comment">// 提取书签并创建书签的游标</span></span><br><span class="line">            RangeFinder rt = <span class="keyword">new</span> RangeFinder(<span class="string">"CTBookmark"</span>, <span class="string">"CTMarkupRange"</span>);</span><br><span class="line">            <span class="keyword">new</span> TraversalUtil(paragraphs, rt);</span><br><span class="line">            <span class="comment">// 遍历书签</span></span><br><span class="line">            <span class="keyword">for</span> (CTBookmark bm : rt.getStarts()) &#123;</span><br><span class="line">                logger.info(<span class="string">"标签名称:"</span> + bm.getName());</span><br><span class="line">                <span class="comment">// 这儿可以对单个书签进行操作，也可以用一个map对所有的书签进行处理</span></span><br><span class="line"><span class="comment">//                List&lt;Map&lt;String, Object&gt;&gt; dataList = getDataList();</span></span><br><span class="line"><span class="comment">//                for (Map&lt;String, Object&gt; map : dataList) &#123;</span></span><br><span class="line"><span class="comment">//                    replaceText(bm, map);</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line">                <span class="keyword">if</span> (bm.getName().equals(<span class="string">"name0"</span>)) &#123;</span><br><span class="line">                    replaceText(bm, <span class="string">"zhangsan"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (bm.getName().equals(<span class="string">"pic01"</span>)) &#123;</span><br><span class="line">                    addImage(wordMLPackage, bm, picPath);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Docx4J.save(wordMLPackage, <span class="keyword">new</span> File(template02outPath));</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"按书签替换内容成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在标签处插入内容</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bm</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">replaceText</span><span class="params">(CTBookmark bm, Object object)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (object == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// do we have data for this one?</span></span><br><span class="line">        <span class="keyword">if</span> (bm.getName() == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        String value = object.toString();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Can't just remove the object from the parent,</span></span><br><span class="line">            <span class="comment">// since in the parent, it may be wrapped in a JAXBElement</span></span><br><span class="line">            List&lt;Object&gt; theList = <span class="keyword">null</span>;</span><br><span class="line">            ParaRPr rpr = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (bm.getParent() <span class="keyword">instanceof</span> P) &#123;</span><br><span class="line">                PPr pprTemp = ((P) (bm.getParent())).getPPr();</span><br><span class="line">                <span class="keyword">if</span> (pprTemp == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    rpr = <span class="keyword">null</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    rpr = ((P) (bm.getParent())).getPPr().getRPr();</span><br><span class="line">                &#125;</span><br><span class="line">                theList = ((ContentAccessor) (bm.getParent())).getContent();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> rangeStart = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> rangeEnd = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (Object ox : theList) &#123;</span><br><span class="line">                Object listEntry = XmlUtils.unwrap(ox);</span><br><span class="line">                <span class="keyword">if</span> (listEntry.equals(bm)) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (((CTBookmark) listEntry).getName() != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">                        rangeStart = i + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (listEntry <span class="keyword">instanceof</span> CTMarkupRange) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (((CTMarkupRange) listEntry).getId().equals(bm.getId())) &#123;</span><br><span class="line">                        rangeEnd = i - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> x = i - <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// if (rangeStart &gt; 0 &amp;&amp; x &gt;= rangeStart) &#123;</span></span><br><span class="line">            <span class="comment">// Delete the bookmark range</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = x; j &gt;= rangeStart; j--) &#123;</span><br><span class="line">                theList.remove(j);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// now add a run</span></span><br><span class="line">            R run = factory.createR();</span><br><span class="line">            Text t = factory.createText();</span><br><span class="line">            <span class="comment">// if (rpr != null)</span></span><br><span class="line">            <span class="comment">// run.setRPr(paraRPr2RPr(rpr));</span></span><br><span class="line">            t.setValue(value);</span><br><span class="line">            run.getContent().add(t);</span><br><span class="line">            <span class="comment">// t.setValue(value);</span></span><br><span class="line"></span><br><span class="line">            theList.add(rangeStart, run);</span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入图片</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> wPackage</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bm</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addImage</span><span class="params">(WordprocessingMLPackage wPackage, CTBookmark bm, String file)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"addImage :-&gt;&#123;&#125;,&#123;&#125;,&#123;&#125;"</span>, wPackage, bm,file);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 这儿可以对单个书签进行操作，也可以用一个map对所有的书签进行处理</span></span><br><span class="line">            <span class="comment">// 获取该书签的父级段落</span></span><br><span class="line">            P p = (P) (bm.getParent());</span><br><span class="line">            <span class="comment">// R对象是匿名的复杂类型</span></span><br><span class="line">            R run = factory.createR();</span><br><span class="line">            <span class="comment">// 读入图片并转化为字节数组，因为docx4j只能字节数组的方式插入图片</span></span><br><span class="line">            <span class="keyword">byte</span>[] bytes = IOUtils.toByteArray(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 开始创建一个行内图片</span></span><br><span class="line">            BinaryPartAbstractImage imagePart = BinaryPartAbstractImage.createImagePart(wPackage, bytes);</span><br><span class="line">            <span class="comment">// 创建内联对象，createImageInline函数最后一个参数是限制图片的宽度，缩放的依据</span></span><br><span class="line">            Inline inline = imagePart.createImageInline(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="keyword">false</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 获取该书签的父级段落</span></span><br><span class="line">            Drawing drawing = factory.createDrawing();</span><br><span class="line">            drawing.getAnchorOrInline().add(inline);</span><br><span class="line">            run.getContent().add(drawing);</span><br><span class="line">            p.getContent().add(run);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-12-综合使用"><a href="#2-12-综合使用" class="headerlink" title="2.12 综合使用"></a>2.12 综合使用</h3><h4 id="2-12-1-工具类"><a href="#2-12-1-工具类" class="headerlink" title="2.12.1 工具类"></a>2.12.1 工具类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhangy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Time</span> 2021-07-12 16:08</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 关于文件操作的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Docx4jUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(Docx4jUtil<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> WordprocessingMLPackage wordMLPackage;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ObjectFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 替换变量并下载word文档</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">downloadDocxUseDoc4j</span><span class="params">(InputStream inputStream,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            Map&lt;String, String&gt; map,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            List&lt;CompositeDocxReq.DataList&gt; dataList,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            List&lt;Map&lt;String, Object&gt;&gt; picList,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            String fileName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            HttpServletResponse response)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        OutputStream outs = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.reset();</span><br><span class="line">            fileName = URLEncoder.encode(fileName, <span class="string">"UTF-8"</span>);</span><br><span class="line">            response.setContentType(<span class="string">"application/octet-stream;charset=UTF-8"</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">            response.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment; filename="</span> + fileName + <span class="string">".docx"</span>);</span><br><span class="line">            response.setHeader(<span class="string">"Access-Control-Expose-Headers"</span>, <span class="string">"Content-Disposition"</span>);</span><br><span class="line"></span><br><span class="line">            outs = response.getOutputStream();</span><br><span class="line">            Docx4jUtil.replaceDocUseDoc4j(inputStream,map,dataList,picList,outs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 替换变量并输出word文档</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> picList</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputStream</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">replaceDocUseDoc4j</span><span class="params">(InputStream inputStream,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          Map&lt;String, String&gt; map,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          List&lt;CompositeDocxReq.DataList&gt; dataList,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          List&lt;Map&lt;String, Object&gt;&gt; picList,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          OutputStream outputStream)</span> </span>&#123;</span><br><span class="line">        MainDocumentPart mainDocumentPart = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage.load(inputStream);</span><br><span class="line">            VariablePrepare.prepare(wordMLPackage);</span><br><span class="line">            mainDocumentPart = wordMLPackage.getMainDocumentPart();</span><br><span class="line">            factory = Context.getWmlObjectFactory();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!CollectionUtils.isEmpty(map) || !CollectionUtils.isEmpty(dataList) || !CollectionUtils.isEmpty(picList)) &#123;</span><br><span class="line">                <span class="comment">// 将$&#123;&#125;里的内容结构层次替换为一层,清扫docx4j模板变量字符</span></span><br><span class="line">                Docx4jUtil.cleanDocumentPart(mainDocumentPart);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//构造循环列表的变量数据</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dataList.size(); i++) &#123;</span><br><span class="line">                    Integer num = dataList.get(i).getNum();</span><br><span class="line">                    Integer trNum = dataList.get(i).getTrNum();</span><br><span class="line">                    ClassFinder find = <span class="keyword">new</span> ClassFinder(Tbl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">                    <span class="keyword">new</span> TraversalUtil(mainDocumentPart.getContent(), find);</span><br><span class="line">                    <span class="comment">//获取到第几个表格元素</span></span><br><span class="line">                    Tbl table = (Tbl) find.results.get(num.intValue());</span><br><span class="line">                    <span class="comment">//第二行约定为模板</span></span><br><span class="line">                    Tr dynamicTr = (Tr) table.getContent().get(trNum.intValue());</span><br><span class="line">                    <span class="comment">//获取模板行的xml数据</span></span><br><span class="line">                    String dynamicTrXml = XmlUtils.marshaltoString(dynamicTr);</span><br><span class="line">                    <span class="keyword">for</span> (Map&lt;String, Object&gt; dataMap : dataList.get(i).getDataInnerList()) &#123;</span><br><span class="line">                        <span class="comment">//填充模板行数据</span></span><br><span class="line">                        Tr newTr = (Tr) XmlUtils.unmarshallFromTemplate(dynamicTrXml, dataMap);</span><br><span class="line">                        table.getContent().add(newTr);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//删除模板行的占位行</span></span><br><span class="line">                    table.getContent().remove(trNum.intValue());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//插入图片</span></span><br><span class="line">                <span class="comment">//书签方式</span></span><br><span class="line">                Document wmlDoc = (Document) mainDocumentPart.getJaxbElement();</span><br><span class="line">                Body body = wmlDoc.getBody();</span><br><span class="line">                <span class="comment">// 提取正文中所有段落</span></span><br><span class="line">                List&lt;Object&gt; paragraphs = body.getContent();</span><br><span class="line">                <span class="comment">// 提取书签并创建书签的游标</span></span><br><span class="line">                RangeFinder rt = <span class="keyword">new</span> RangeFinder(<span class="string">"CTBookmark"</span>, <span class="string">"CTMarkupRange"</span>);</span><br><span class="line">                <span class="keyword">new</span> TraversalUtil(paragraphs, rt);</span><br><span class="line">                <span class="comment">// 遍历书签</span></span><br><span class="line">                <span class="keyword">for</span> (CTBookmark bm : rt.getStarts()) &#123;</span><br><span class="line">                    logger.info(<span class="string">"标签名称:"</span> + bm.getName());</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; picList.size(); i++) &#123;</span><br><span class="line">                        Map&lt;String, Object&gt; stringObjectMap = picList.get(i);</span><br><span class="line">                        Set&lt;String&gt; keys = stringObjectMap.keySet();</span><br><span class="line">                        <span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(bm.getName().equals(key))&#123;</span><br><span class="line">                                addImage(wordMLPackage, bm, (String) stringObjectMap.get(key));</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 设置全局的变量替换</span></span><br><span class="line">                mainDocumentPart.variableReplace(map);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 输出word文件</span></span><br><span class="line">            wordMLPackage.save(outputStream);</span><br><span class="line">            outputStream.flush();</span><br><span class="line">            <span class="comment">//输出文件到保存地点</span></span><br><span class="line"><span class="comment">//            wordMLPackage.save(new File("/home/person-project/template02_out.docx"));</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage(), e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != outputStream)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    outputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    logger.error(e.getMessage());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * cleanDocumentPart</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> documentPart</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">cleanDocumentPart</span><span class="params">(MainDocumentPart documentPart)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (documentPart == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Document document = documentPart.getContents();</span><br><span class="line">        String wmlTemplate =</span><br><span class="line">                XmlUtils.marshaltoString(document, <span class="keyword">true</span>, <span class="keyword">false</span>, Context.jc);</span><br><span class="line">        document = (Document) XmlUtils.unwrap(DocxVariableClearUtils.doCleanDocumentPart(wmlTemplate, Context.jc));</span><br><span class="line">        documentPart.setContents(document);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清扫 docx4j 模板变量字符,通常以$&#123;variable&#125;形式</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">XXX:</span> 主要在上传模板时处理一下, 后续</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> zhangy</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Time</span> 2021-07-12 16:08</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DocxVariableClearUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 去任意XML标签</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Pattern XML_PATTERN = Pattern.compile(<span class="string">"&lt;[^&gt;]*&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">DocxVariableClearUtils</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * start符号</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span> PREFIX = <span class="string">'$'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 中包含</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span> LEFT_BRACE = <span class="string">'&#123;'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 结尾</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span> RIGHT_BRACE = <span class="string">'&#125;'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 未开始</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NONE_START = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 未开始</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NONE_START_INDEX = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 开始</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PREFIX_STATUS = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 左括号</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LEFT_BRACE_STATUS = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 右括号</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RIGHT_BRACE_STATUS = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * doCleanDocumentPart</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> wmlTemplate</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> jc</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         * <span class="doctag">@throws</span> JAXBException</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title">doCleanDocumentPart</span><span class="params">(String wmlTemplate, JAXBContext jc)</span> <span class="keyword">throws</span> JAXBException </span>&#123;</span><br><span class="line">            <span class="comment">// 进入变量块位置</span></span><br><span class="line">            <span class="keyword">int</span> curStatus = NONE_START;</span><br><span class="line">            <span class="comment">// 开始位置</span></span><br><span class="line">            <span class="keyword">int</span> keyStartIndex = NONE_START_INDEX;</span><br><span class="line">            <span class="comment">// 当前位置</span></span><br><span class="line">            <span class="keyword">int</span> curIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">char</span>[] textCharacters = wmlTemplate.toCharArray();</span><br><span class="line">            StringBuilder documentBuilder = <span class="keyword">new</span> StringBuilder(textCharacters.length);</span><br><span class="line">            documentBuilder.append(textCharacters);</span><br><span class="line">            <span class="comment">// 新文档</span></span><br><span class="line">            StringBuilder newDocumentBuilder = <span class="keyword">new</span> StringBuilder(textCharacters.length);</span><br><span class="line">            <span class="comment">// 最后一次写位置</span></span><br><span class="line">            <span class="keyword">int</span> lastWriteIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c : textCharacters) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (c) &#123;</span><br><span class="line">                    <span class="keyword">case</span> PREFIX:</span><br><span class="line">                        <span class="comment">// TODO 不管其何状态直接修改指针,这也意味着变量名称里面不能有PREFIX</span></span><br><span class="line">                        keyStartIndex = curIndex;</span><br><span class="line">                        curStatus = PREFIX_STATUS;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> LEFT_BRACE:</span><br><span class="line">                        <span class="keyword">if</span> (curStatus == PREFIX_STATUS) &#123;</span><br><span class="line">                            curStatus = LEFT_BRACE_STATUS;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> RIGHT_BRACE:</span><br><span class="line">                        <span class="keyword">if</span> (curStatus == LEFT_BRACE_STATUS) &#123;</span><br><span class="line">                            <span class="comment">// 接上之前的字符</span></span><br><span class="line">                            newDocumentBuilder.append(documentBuilder.substring(lastWriteIndex, keyStartIndex));</span><br><span class="line">                            <span class="comment">// 结束位置</span></span><br><span class="line">                            <span class="keyword">int</span> keyEndIndex = curIndex + <span class="number">1</span>;</span><br><span class="line">                            <span class="comment">// 替换</span></span><br><span class="line">                            String rawKey = documentBuilder.substring(keyStartIndex, keyEndIndex);</span><br><span class="line">                            <span class="comment">// 干掉多余标签</span></span><br><span class="line">                            String mappingKey = XML_PATTERN.matcher(rawKey).replaceAll(<span class="string">""</span>);</span><br><span class="line">                            <span class="keyword">if</span> (!mappingKey.equals(rawKey)) &#123;</span><br><span class="line">                                <span class="keyword">char</span>[] rawKeyChars = rawKey.toCharArray();</span><br><span class="line">                                <span class="comment">// 保留原格式</span></span><br><span class="line">                                StringBuilder rawStringBuilder = <span class="keyword">new</span> StringBuilder(rawKey.length());</span><br><span class="line">                                <span class="comment">// 去掉变量引用字符</span></span><br><span class="line">                                <span class="keyword">for</span> (<span class="keyword">char</span> rawChar : rawKeyChars) &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (rawChar == PREFIX || rawChar == LEFT_BRACE || rawChar == RIGHT_BRACE) &#123;</span><br><span class="line">                                        <span class="keyword">continue</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    rawStringBuilder.append(rawChar);</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="comment">// FIXME 要求变量连在一起</span></span><br><span class="line">                                String variable = mappingKey.substring(<span class="number">2</span>, mappingKey.length() - <span class="number">1</span>);</span><br><span class="line">                                <span class="keyword">int</span> variableStart = rawStringBuilder.indexOf(variable);</span><br><span class="line">                                <span class="keyword">if</span> (variableStart &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                                    rawStringBuilder = rawStringBuilder.replace(variableStart, variableStart + variable.length(), mappingKey);</span><br><span class="line">                                &#125;</span><br><span class="line">                                newDocumentBuilder.append(rawStringBuilder.toString());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                newDocumentBuilder.append(mappingKey);</span><br><span class="line">                            &#125;</span><br><span class="line">                            lastWriteIndex = keyEndIndex;</span><br><span class="line"></span><br><span class="line">                            curStatus = NONE_START;</span><br><span class="line">                            keyStartIndex = NONE_START_INDEX;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                curIndex++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 余部</span></span><br><span class="line">            <span class="keyword">if</span> (lastWriteIndex &lt; documentBuilder.length()) &#123;</span><br><span class="line">                newDocumentBuilder.append(documentBuilder.substring(lastWriteIndex));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> XmlUtils.unmarshalString(newDocumentBuilder.toString(), jc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入图片</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> wPackage</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bm</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addImage</span><span class="params">(WordprocessingMLPackage wPackage, CTBookmark bm, String file)</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"addImage :-&gt;&#123;&#125;,&#123;&#125;,&#123;&#125;"</span>, wPackage, bm,file);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 这儿可以对单个书签进行操作，也可以用一个map对所有的书签进行处理</span></span><br><span class="line">            <span class="comment">// 获取该书签的父级段落</span></span><br><span class="line">            P p = (P) (bm.getParent());</span><br><span class="line">            <span class="comment">// R对象是匿名的复杂类型</span></span><br><span class="line">            R run = factory.createR();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读入图片并转化为字节数组，因为docx4j只能字节数组的方式插入图片</span></span><br><span class="line">            <span class="keyword">byte</span>[] bytes = IOUtils.toByteArray(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">            <span class="comment">// 开始创建一个行内图片</span></span><br><span class="line">            BinaryPartAbstractImage imagePart = BinaryPartAbstractImage.createImagePart(wPackage, bytes);</span><br><span class="line">            <span class="comment">// 创建内联对象，createImageInline函数最后一个参数是限制图片的宽度，缩放的依据</span></span><br><span class="line">            Inline inline = imagePart.createImageInline(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="keyword">false</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 获取该书签的父级段落</span></span><br><span class="line">            Drawing drawing = factory.createDrawing();</span><br><span class="line">            drawing.getAnchorOrInline().add(inline);</span><br><span class="line">            run.getContent().add(drawing);</span><br><span class="line">            p.getContent().add(run);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * docx转html文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputPath</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">docx2Html</span><span class="params">(String inputPath)</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> nestLists = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wordMLPackage = WordprocessingMLPackage</span><br><span class="line">                    .load(<span class="keyword">new</span> File(inputPath));</span><br><span class="line">            HTMLSettings htmlSettings = Docx4J.createHTMLSettings();</span><br><span class="line">            htmlSettings.setImageDirPath(inputPath + <span class="string">"_files"</span>);</span><br><span class="line">            htmlSettings.setImageTargetUri(inputPath.substring(inputPath.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>) + <span class="string">"_files"</span>);</span><br><span class="line">            htmlSettings.setWmlPackage(wordMLPackage);</span><br><span class="line"></span><br><span class="line">            String userCSS = <span class="keyword">null</span>;</span><br><span class="line">            <span class="comment">//userCSS是生成的html的样式，可以手动设置，使用此参数可以灵活的设置边距字体等信息</span></span><br><span class="line">            <span class="keyword">if</span> (nestLists) &#123;</span><br><span class="line">                userCSS = <span class="string">"html, body, div, span, h1, h2, h3, h4, h5, h6, p, a, img,  table, caption, tbody, tfoot, thead, tr, th, td "</span></span><br><span class="line">                        + <span class="string">"&#123; margin: 0; padding: 0; border: 0;&#125;"</span> + <span class="string">"body &#123;line-height: 1;&#125; "</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                userCSS = <span class="string">"html, body, div, span, h1, h2, h3, h4, h5, h6, p, a, img,  ol, ul, li, table, caption, tbody, tfoot, thead, tr, th, td "</span></span><br><span class="line">                        + <span class="string">"&#123; margin: 0; padding: 0; border: 0;&#125;"</span> + <span class="string">"body &#123;line-height: 1;&#125; "</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            htmlSettings.setUserCSS(userCSS);</span><br><span class="line"></span><br><span class="line">            Docx4jProperties.setProperty(<span class="string">"docx4j.Convert.Out.HTML.OutputMethodXML"</span>, <span class="keyword">true</span>);</span><br><span class="line">            Docx4J.toHTML(htmlSettings, <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(inputPath + <span class="string">".html"</span>)),</span><br><span class="line">                    Docx4J.FLAG_EXPORT_PREFER_XSL);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (wordMLPackage.getMainDocumentPart().getFontTablePart() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                wordMLPackage.getMainDocumentPart().getFontTablePart().deleteEmbeddedFontTempFiles();</span><br><span class="line">            &#125;</span><br><span class="line">            htmlSettings = <span class="keyword">null</span>;</span><br><span class="line">            wordMLPackage = <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-12-2-下载docx请求参数"><a href="#2-12-2-下载docx请求参数" class="headerlink" title="2.12.2 下载docx请求参数"></a>2.12.2 下载docx请求参数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhangy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Time</span> 2021-07-13 16:10</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 下载docx请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompositeDocxReq</span> </span>&#123;</span><br><span class="line">    <span class="comment">//非循环列表的变量数据</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; mappings;</span><br><span class="line">    <span class="comment">//多个循环列表</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;DataList&gt; dataList;</span><br><span class="line">    <span class="comment">//图片数据</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Map&lt;String, Object&gt;&gt; picList;</span><br><span class="line">    <span class="comment">//导出文件名</span></span><br><span class="line">    <span class="keyword">private</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DataList</span></span>&#123;</span><br><span class="line">        <span class="comment">//循环列表的变量数据</span></span><br><span class="line">        <span class="keyword">private</span> List&lt;Map&lt;String , Object&gt;&gt; dataInnerList;</span><br><span class="line">        <span class="comment">//处于docx中的表格序号，从0开始</span></span><br><span class="line">        <span class="keyword">private</span> Integer num;</span><br><span class="line">        <span class="comment">//模板占位符变量行数，从0开始</span></span><br><span class="line">        <span class="keyword">private</span> Integer trNum;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; getDataInnerList() &#123;</span><br><span class="line">            <span class="keyword">return</span> dataInnerList;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataInnerList</span><span class="params">(List&lt;Map&lt;String, Object&gt;&gt; dataInnerList)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.dataInnerList = dataInnerList;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> num;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNum</span><span class="params">(Integer num)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.num = num;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getTrNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> trNum;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTrNum</span><span class="params">(Integer trNum)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.trNum = trNum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getMappings</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mappings;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMappings</span><span class="params">(Map&lt;String, String&gt; mappings)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mappings = mappings;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;DataList&gt; <span class="title">getDataList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dataList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataList</span><span class="params">(List&lt;DataList&gt; dataList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataList = dataList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; getPicList() &#123;</span><br><span class="line">        <span class="keyword">return</span> picList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPicList</span><span class="params">(List&lt;Map&lt;String, Object&gt;&gt; picList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.picList = picList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFileName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFileName</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fileName = fileName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-12-3-使用"><a href="#2-12-3-使用" class="headerlink" title="2.12.3 使用"></a>2.12.3 使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 综合使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/composite"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">composite</span><span class="params">(@RequestBody CompositeDocxReq compositeDocxReq, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">        MainDocumentPart mainDocumentPart = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//工具类下载</span></span><br><span class="line">            Docx4jUtil.downloadDocxUseDoc4j(<span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(template02Path)),</span><br><span class="line">                    compositeDocxReq.getMappings(),</span><br><span class="line">                    compositeDocxReq.getDataList(),</span><br><span class="line">                    compositeDocxReq.getPicList(),</span><br><span class="line">                    compositeDocxReq.getFileName(),</span><br><span class="line">                    response);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"综合使用调用成功"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一、前言&quot;&gt;&lt;a href=&quot;#一、前言&quot; class=&quot;headerlink&quot; title=&quot;一、前言&quot;&gt;&lt;/a&gt;一、前言&lt;/h1&gt;&lt;p&gt;docx4j 是一个开源（ASLv2）Java 库，&lt;strong&gt;用于创建和处理 Microsoft Open XML（Word docx，Powerpoint pptx 和 Excel xlsx）文件&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;docx4j 官网：&lt;a href=&quot;https://www.docx4java.org/trac/docx4j&quot; rel=&quot;external nofollow noopener noreferrer&quot;  style=&quot;text-decoration:none;&quot; target=&quot;_blank&quot;&gt;传送门&lt;/a&gt;                                                                                       &lt;/p&gt;
&lt;p&gt;docx4j 示例代码 ：&lt;a href=&quot;https://github.com/plutext/docx4j&quot; rel=&quot;external nofollow noopener noreferrer&quot;  style=&quot;text-decoration:none;&quot; target=&quot;_blank&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Microsoft Open XML" scheme="http://yoursite.com/tags/Microsoft-Open-XML/"/>
    
  </entry>
  
  <entry>
    <title>Alpha、Beta、RC、GA 版本的区别</title>
    <link href="http://yoursite.com/2021/02/21/Alpha%E3%80%81Beta%E3%80%81RC%E3%80%81GA-%E7%89%88%E6%9C%AC%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>http://yoursite.com/2021/02/21/Alpha%E3%80%81Beta%E3%80%81RC%E3%80%81GA-%E7%89%88%E6%9C%AC%E7%9A%84%E5%8C%BA%E5%88%AB/</id>
    <published>2021-02-21T12:04:22.000Z</published>
    <updated>2021-07-09T12:47:03.760Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>Alpha：是内部测试版, 一般不向外部发布, 会有很多 Bug. 一般只有测试人员使用。</p><p>Beta：也是测试版，这个阶段的版本会一直加入新的功能。在 Alpha 版之后推出。</p><a id="more"></a><p>RC：(Release　Candidate) 顾名思义么 ! 用在软件上就是候选版本。系统平台上就是发行候选版本。RC 版不会再加入新的功能了，主要着重于除错。</p><p>GA:General Availability, 正式发布的版本，在国外都是用 GA 来说明 release 版本的。</p><p>RTM：(Release to Manufacture) 是给工厂大量压片的版本，内容跟正式版是一样的，不过 RTM 版也有出限制、评估版的。但是和正式版本的主要程序代码都是一样的。</p><p>OEM：是给计算机厂商随着计算机贩卖的，也就是随机版。只能随机器出货，不能零售。只能全新安装，不能从旧有操作系统升级。包装不像零售版精美，通常只有一面 CD 和说明书 (授权书)。</p><p>RVL：号称是正式版，其实 RVL 根本不是版本的名称。它是中文版 / 英文版文档破解出来的。</p><p>EVAL：而流通在网络上的 EVAL 版，与 “评估版” 类似，功能上和零售版没有区别。</p><p>RTL：Retail(零售版) 是真正的正式版，正式上架零售版。在安装盘的 i386 文件夹里有一个 eula.txt，最后有一行 EULAID，就是你的版本。比如简体中文正式版是 EULAID:WX.4_PRO_RTL_CN，繁体中文正式版是 WX.4_PRO_RTL_TW。其中：如果是 WX. 开头是正式版，WB. 开头是测试版。_PRE，代表家庭版；_PRO，代表专业版。</p><p>α、β、λ常用来表示软件测试过程中的三个阶段，α是第一阶段，一般只供内部测试使用；β是第二个阶段，已经消除了软件中大部分的不完善之处，但仍有可能还存在缺陷和漏洞，一般只提供给特定的用户群来测试使用；λ是第三个阶段，此时产品已经相当成熟，只需在个别地方再做进一步的优化处理即可上市发行。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Alpha：是内部测试版, 一般不向外部发布, 会有很多 Bug. 一般只有测试人员使用。&lt;/p&gt;
&lt;p&gt;Beta：也是测试版，这个阶段的版本会一直加入新的功能。在 Alpha 版之后推出。&lt;/p&gt;
    
    </summary>
    
    
      <category term="计算机" scheme="http://yoursite.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
    
      <category term="版本区别" scheme="http://yoursite.com/tags/%E7%89%88%E6%9C%AC%E5%8C%BA%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>高考，一碗端不平的水</title>
    <link href="http://yoursite.com/2020/08/29/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/"/>
    <id>http://yoursite.com/2020/08/29/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/</id>
    <published>2020-08-29T04:59:44.000Z</published>
    <updated>2020-08-29T05:49:08.057Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><strong>为什么高考题难度经常「漂移」？为什么高考改革总是走回头路？</strong>  </p><a id="more"></a><p><strong>文｜张蔓生</strong></p><p>「高考是相对最公平的考试，是千军万马过独木桥，也是穷孩子唯一的出路。」在坊间，这样的观点十分盛行。</p><p>的确，如果不考虑舞弊等少数情况，比起前三十年拼「群众推荐」、拼「家庭出身」、「工农兵上大学」等等，当代高考确实是程序正义方面的长足进步。但每到高考前，人们总会有些疑问，如：</p><blockquote><p><strong>上海、北京、天津的 211 高校录取率超过 10%，而人口大省安徽、河南、山东、广东等不到 4%；</strong></p><p><strong>各省份内部的教育资源愈加内卷化，富裕地区靠家长「氪金」，一般地区靠超级中学的抽水机效应；</strong></p><p><strong>高考题的难度本就飘忽不定，遇上疫情年则更难令人放心。</strong></p></blockquote><p>高考的辩护者们通常将这些问题归罪于优质教育资源的稀缺。他们会说，北大清华的名额毕竟有限，中国各省经济发展水平差异巨大，高考又是选拔性考试，不能把锅丢给高考。</p><p>很少有人意识到，高考这根指挥棒本身也是不公平的真正根源 —— 从考试和考题设计，到录取计划，再到其背后的央地行政和财政关系。</p><p><strong>分数的玄机</strong></p><p>从恢复高考以来，中国的高考制度设计一直有两股力量在拉扯：一边是地方政府和省部共建高校在招录中的作用，一边是中央的财政支持及其在高考中的话语权。</p><p>相应，这两股力量在外观表现上分成两方：前者的诉求是各省自主命题、高校自主招生和伴生的「素质教育」口号，后者则是全国统一命题、题目标准化和分数标准化。</p><p>至于考生群体的利益，双方都以此作为改革的旗号，国内却并没有完善的研究，来指出到底怎样考才对考生们最公平。大多数考试政策直到民怨载道才作出改变，却总是从一个极端改到另一个极端。</p><p>在各年度、各省之间，高考分数不能拿来横向比较。这是因为高考大体上是非标准化考试。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E7%A8%B3%E5%AE%9A%E9%85%8D%E7%BD%AE%E7%90%86%E8%AE%BA.png" alt=""></strong></p><p><strong>· 高考不但是一场考试，还是一套算法。按照经济学的「稳定配置理论」，它和拍卖规则类似，是一种保证分数 - 录取水平匹配的算法。相关理论曾获得 2012 年诺贝尔经济学奖，但至今成果仍未应用到中国的制度设计中</strong></p><p>大多数我们所知的出国考试，比如托福、雅思、GRE、SAT 等等，都是标准化考试。这些考试的每次分数会根据统计学原理，进行一套复杂的数学调整，以保证分数不受考试地点、题目、场次的限制。</p><p>比如，托福英语机考满分 120 分，听说读写四门各 30 分。它的出题不是按「套」来的，而是按「道」来的。考试机构会邀请一些出题专家，按照一定的要求一道道出题，按「道」给钱，形成一个题库，每道题有自己的难度权重。</p><p>每次托福考试，系统会按照固定的权重要求，一个类目的题筛选若干道，「攒」成一套难度标准化的试卷。</p><p>当你考完之后，系统按照所有考生排名的百分等级，算出一套统计学标准分。比如说，托福阅读满分 30 分，28 分的百分等级为 84，也就是说当你得了 28 分，就超过了 84% 的考生。</p><p>因此你在任何场次考的托福分数意义都一样，可以横向比较。国外高校录取，也只需给出诸如「托福 100 分以上」的直接要求即可。</p><p>中国高考长期以来是非标准化考试，这也是央地拉锯战的结果。</p><p>80 年代初刚恢复高考时，由于教育部命题水平一般、各地的批卷标准参差不齐，当时的高考题非常简陋，很难说有任何科学性。学者们按照教育科学标准，统计了全国高考的情况，发现很多试题效度极低、信度为负。</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/1979%E5%B9%B4%E7%9A%84%E5%8C%97%E4%BA%AC%E9%AB%98%E8%80%83%E8%90%BD%E6%A6%9C%E8%80%83%E7%94%9F%E4%B8%93%E6%A0%8F.webp" alt=""></p><p><strong>· 1979 年的北京高考落榜考生专栏</strong></p><p>当时参与的专家之一张厚粲说：</p><blockquote><p><strong>有些文科卷子，只四大道论述题平分天下…… 拿语文来说，同一张答卷，五个地区打分能差出 32 分来，数学也差 15 分。</strong></p></blockquote><p>中国高校的录取名额必须由国家公平分配，这关系到社会稳定。眼看高考报名人数逐年增加，长此以往是不行的。经过研究，国家决定推行高考标准化。</p><p>1985 年，最早的标准分改革开始在广东试点，后来推行至多个省区，到 1997 年一度覆盖全国三分之一的考生。这些省份在降低难度、3+X 自选科目（数语外三门必考加若干门选考科目）的同时，把所有原始分（满分多为 750 ）按统计曲线标准化为满分 900 的标准分。</p><p>按理说，标准分能够让学生非常明确地知道自己在全省的名次，有利于志愿投递，也有利于高校录取，更有利于试题标准化和复习备考，是一举多得的好事，但这个制度很快就遭遇了滑铁卢。</p><p>3+X 标准分从人人欢迎到怨声载道，只用不到二十年。到 2010 年，沿用标准分制度的省份只剩海南一个，其他省份都改回了原始分。</p><p>为什么会这样？</p><p>标准分的确更科学，但这不等于在任何情况下，标准化都比原始分更公平。</p><p>在考生眼里，3+X 标准分比原始分糟糕很多。除了黑箱操作的隐患，它还带来一个巨大的问题：标准化带来的「局部利益调整」。</p><p>考试各科的分数是分别标准化的，但比较的时候大家是放在一起比的，这就造成了名次的移动。</p><p>大部分标准化考试的出题对于考生成绩的分布都有一定的把控。即便不经过调整，单靠题目难度分布的作用，大家的原始分也近似满足一定的规律，统计学调整只不过是最后一步。</p><p>中国高考的出题水平则远远达不到这么精准。</p><p>高考没有题库，每年的高考命题由教育部考试中心或省里现组班子，题目标准化程度低下，原始分的统计分布飘忽不定。因此，高考分数经过标准化之后往往漂移得更厉害。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E5%AD%A6%E4%B9%A0.webp" alt=""></strong></p><p><strong>· 尽管教育部多次强调今年的出题会求稳，但有了 2003 年非典年「超难数学」的前车之鉴，谁也不敢在此时掉以轻心</strong></p><p>比如，语文的成绩分布经常比较集中，所以原始分差一分，经过统计学调整，标准分会差好几分乃至十几分。如果来一个偏科的考生，语文特别好，就会很占优势。</p><p>另外，3+X 除了必考的数语英三门，还有三门可以自选。当某一科考生总体水平都不太好，考得好的学生就会比选其他科目的学生得更多的标准分，考取更好的学校（高校录取分数线是按处理后的标准分总分划定的）。</p><p><strong>对排名靠中间、恰好卡在上线和落榜之间的学生而言，这样的调整会造成极大的不确定性。全部考生中，大约 7% 会在这个调整中命运被悄然改变，由上线变为落榜。十多年间，这个群体的人数可能多达几十万。</strong></p><p>这一现象被学界称为「局部利益调整」，比任何顶替都影响深远。而且，由于原始分排名不公开，他们根本没办法知道自己是否因此落榜。</p><p>3+X 还存在专业壁垒问题。各大学专业有自己对应的选考科目要求，如一个学生没有选「物理」，就不能报考需要「物理」这个单项的专业。这种专业壁垒加大了选专业的难度，还可能造成某些专业由于高考选科偏差而人数过少。</p><p>随着试点省份一个个回到原始分，中央对考生进行「统一分配」的第一轮尝试就这样宣告失败了。</p><p>在潮流中，更多省份则选择观望，并逐渐走向故事的另一面：自主命题、自主招生，以及「素质教育」。</p><p><strong>谁来决定录取计划</strong></p><p>如果中央不能有效、合理地将学生分配给高校，那么各个地方就只有自己来了。</p><p><strong>在中国，由于「省部共建」，公办高校和地方经常是绑定在一起的。</strong>跟随财政体制改革的步伐，从 1998 年起，全国 200 多所部属高校下划到地方共建，剩余的 76 所教育部直属高校和 38 所部属高校也高度依赖地方财政。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E4%B8%AD%E5%9B%BD%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6.webp" alt=""></strong></p><p><strong>· 中国科技大学是中国科学院所属，但拨款来源中，教育部、中科院和安徽省各占三分之一</strong></p><p>制定高校招生计划的利益关系主要有三方面：中央、高校所属地方、高校。</p><p>中央的立场是，一方面考虑宏观就业问题与人力资源分配，有权决定总体上扩招还是缩招，以及是否在需要人才的发达地区扩大招生规模，另一方面，又要保证地区之间的公平。</p><p>地方政府和高校则经常是利益共同体。它们都想让更多优质生源来到自己麾下，来促进经济发展、多拿拨款。同时，地方政府还希望扩大本地的教育福利，因此有着多招自己人的意愿。</p><p>财政改革之后，高校既然拿地方的钱，录取名额就必然会向地方倾斜，而且因地域经济差异而差距悬殊。</p><p>这场三方博弈没有永远的赢家，但有永远的局外人：考生。</p><p>高考刚恢复的时候，国家严格配给招生指标，高校却利用双轨制，大量在计划之外招收计划生、委培生。不得已，1993 年国家首次允许省属高校自行编制招生计划。</p><p>1998 年，为了填补 985、211 工程的财政空缺，「省部共建」政策出台，中央与地方按原则上 1:1 的比例为高校拨款。为了争取地方支持，各大高校不约而同地多招本地人来。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E9%83%91%E5%BC%BA.webp" alt=""></strong></p><p><strong>· 2016 年两会上，时任贵州大学校长郑强说：「中国还有 13 个省份没有一所教育部直属的大学」，其中包括人口大省河南、河北。在地方保护性招录下，这些省份的学生很难被招生计划青睐</strong></p><p><strong>与自定招生计划同时起步的，是高考的分省自主命题。</strong></p><p>2003 年非典当年，泄密事件和整体跑偏的超难全国卷给了各省教育部门以口实。第二年，全国共有 11 个省份进行了高考自主命题，公开的名义是有利素质教育、适应当地情况，让高考更公平。</p><p>实际上，这不过是高等教育地方保护主义的延续：既然招生计划已经分省、已经倾向当地，不如就干脆让省份之间无法互相比较更好。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E9%9D%92%E5%B2%9B%E4%B8%89%E5%90%8D%E8%80%83%E7%94%9F%E7%8A%B6%E5%91%8A%E6%95%99%E8%82%B2%E9%83%A8%E8%BF%9D%E5%AE%AA.png" alt=""></strong></p><p><strong>· 2001 年，由于统一高考山东的录取分数线与北京相差太大，青岛三名考生状告教育部违宪。次年，北京上海率先开始自主命题</strong></p><p>十多年来，我们并未看到高考分省命题对素质教育有何促进。素质教育的核心 —— 减负、反应试、多元化培养 —— 全都无法落实，教育界收获的只是十多份大同小异的考试题。</p><p><strong>在省权扩大的背景下，高考进一步远离标准化。</strong></p><p>外行很可能认为今天的中国高考已经很正规。在手批时代，即便全国统一命题，由于批卷标准不同，高考分数也有极大省际差异和个人运气成分。</p><p>如今，大部分省的高考卷都采用光电批阅，先由计算机扫描答题纸，再用技术按题切分，每道题分给两位老师批阅，如果分数差异超过限度，则发给第三个老师仲裁。</p><p>这看上去非常公平公正，但实际上，高考的很多主观题是没有标准化评分体系的。</p><p>就以作文为例。标准化考试凡有作文的，都会在虚标准之外给出一系列分档例文，和考纲一起，展示给考生看：写成这样 5 分，写成这样 4 分，诸如此类，并且通常都会给出样题库。但高考没有。</p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E7%BE%8E%E5%9B%BD%E8%B5%8B%E5%88%86%E8%A7%84%E5%88%99.png" alt=""></strong></p><p><strong>· 「美国高考」SAT 考试官网上的例文，有细项分数和解释</strong></p><p>高考作文的出题决策过程成谜，不同省的批阅过程和给分标准更是成谜，每个省都有作文的「考经」，不同省的套路难以互相参考。为了不被仲裁影响考核，阅卷老师多打中等分，也造成了语文成绩分布聚集的现象。</p><p>试题越飘忽，对广大考生就越不利。试题太难，他们会集体失分，聚集到低分段，拉不开档次；题目太简单，他们又会集中到较高分段，一样拉不开档次。</p><p>国家和教育行业也意识到了这些问题。<strong>从 2014 年开始，随着考试相关权力重新收归中央，高考改革风向也开始掉头，重新转向国家统一命题、统一标准化考试，回归二十年前的 3+3 考试模式。</strong></p><p>截至 2019 年，新高考改革已经进行了三批，推进到 14 个省份，并逐渐走向全国统一命题。这 14 个省份的自选科目分别采用六种不同的统计学赋分规则。</p><p><strong>· 这些赋分规则要么使用标准分，要么将考试成绩按照一定的排名比例，划分成若干等级，按等级换算成不同分数。它们也根据成绩的统计分布进行校正，相当于改良的标准分</strong></p><p><strong><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E9%AB%98%E8%80%83%EF%BC%8C%E4%B8%80%E7%A2%97%E7%AB%AF%E4%B8%8D%E5%B9%B3%E7%9A%84%E6%B0%B4/%E8%B5%8B%E5%88%86%E8%A7%84%E5%88%99.png" alt=""></strong></p><p><strong>· 例如：北京市的小明同学高考选择了物理、历史和地理三门科目参加等级性考试，其卷面成绩分别在选考该科目的考生中排到 20%、5% 和 13%，对应的等级分别为 B1、A3 和 A5，根据等级折算规则，计入本科高校录取总成绩的分值分别为 85 分、94 分和 88 分</strong></p><p>但二十年前就广受批评的「局部利益调整」、自选科目造成的给分玄学和专业壁垒等问题，现在也跟着回来了。</p><p>比如，由于物理的学习难度较大，很多「学渣」早早避开了物理，导致中等水平的学生相对排名靠后。在标准化处理后，这些考生会比选择其他科目的人吃亏得多。</p><p>越来越多的中等水平考生便放弃物理，而这样又加速恶化了给分问题，让更多人不愿选物理。官方只能采用在招生时设置专业壁垒等方式，逼学生选物理，但仍不能阻止选物理的人数年年缩减的现象。</p><p>随之而来的，则是自选科目人数突然变化引起的教师资源浪费、自选课对固定班级制的冲击等一系列问题。</p><p>高考是一场博弈，不但是学生与学生之间的博弈，还是中央、地方、高校与考生群体之间，各个行政和财政主体之间的博弈。</p><p>在这场更大的博弈中，当属考生群体最没有话语权。对于考生，真正的公平还很遥远。</p><p>参考文献：</p><p>[1] 闫然. 高考招生与教育行政体制改革——央地关系视角下的重塑考量 [J]. 行政与法, 2014, 000(001):15-20.</p><p>[2] 孙科技. 教育政策执行碎片化及其防治策略: 一个整体性治理的视角 [J]. 教育发展研究, 2018.</p><p>[3]李峻. 我国高考政策变迁研究——基于 “利益相关者理论” 的分析[D]. 华中科技大学.</p><p>[4] 章建石. 一项公平与效率兼备的高考改革为什么难以为继?——标准分制度的变迁及其折射的治理困境 [J]. 北京师范大学学报 (社会科学版), 2016, No.253(01):32-42.</p><p>[5] 赵国政. 高考标准分制度改进研究——以海南省为例 [D]. 2016.</p><p>[6] 李坤明. 基于双边匹配理论的中国高考录取机制研究 [D]. 华南理工大学.</p><p>[7] 韩秀云. 稳定配置理论与中国医疗和高考招生改革——2012 年度诺贝尔经济学奖解读 [J]. 经济学动态, 2012, 000(012):107-114.</p><p>[8] 刘海峰, 李立峰. 高考改革与政治经济的关系 [J]. 教育发展研究, 2002(6):34-38.</p><p>[9] 魏晓雪. 从高考分省定额录取制度看教育公平 [D].2016</p><p>[10] 刘海峰, 李木洲. 高考分省定额制的形成与调整 [J]. 教育研究, 2014(06):73-80.</p><p>[11] 关义和. 重点大学招生配额公平性研究 [D]. 暨南大学, 2008.</p><p>[12] 李立峰. 高考自主命题利弊论析 [J]. 湖北招生考试, 2004, 000(004):P.7-11.</p><p>[13] 张千帆. 大学招生考试多元化的宪法底线 [J]. 法商研究, 2010</p><p>[14] 丁鑫. 素质教育与高考制度改革探析 [D]. 辽宁师范大学, 2002.</p><p>[15] 孙永方, 胡建华. 新课改 · 高考 · 素质教育 [J]. 文教资料, 2007, No.406(26):83-85.</p><p>[16] <a href="http://www.gov.cn/zhengce/content/2014-09/04/content_9065.htm" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">国务院关于深化考试招生制度改革的实施意见 国发〔2014〕35 号</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;为什么高考题难度经常「漂移」？为什么高考改革总是走回头路？&lt;/strong&gt;  &lt;/p&gt;
    
    </summary>
    
    
      <category term="教育" scheme="http://yoursite.com/categories/%E6%95%99%E8%82%B2/"/>
    
    
      <category term="高考公平" scheme="http://yoursite.com/tags/%E9%AB%98%E8%80%83%E5%85%AC%E5%B9%B3/"/>
    
  </entry>
  
  <entry>
    <title>支付宝不完全指南</title>
    <link href="http://yoursite.com/2020/07/04/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/"/>
    <id>http://yoursite.com/2020/07/04/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/</id>
    <published>2020-07-04T14:18:18.000Z</published>
    <updated>2020-08-29T05:09:33.827Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="一、免费下载全网论文"><a href="#一、免费下载全网论文" class="headerlink" title="一、免费下载全网论文"></a>一、免费下载全网论文</h3><p>不是在校大学生需要使用论文资料，如何下载论文呢？:sob:</p><a id="more"></a><h4 id="1-使用支付宝办理浙江图书馆读者证"><a href="#1-使用支付宝办理浙江图书馆读者证" class="headerlink" title="1.使用支付宝办理浙江图书馆读者证"></a>1.使用支付宝办理浙江图书馆读者证</h4><ul><li><p>在支付宝首页搜索<strong>浙江图书馆</strong>，关注该生活号； </p></li><li><p>在生活号菜单界面点击<strong>服务</strong>–&gt;点击<strong>服务大厅</strong>，在服务大厅点击<strong>新用户注册</strong>，进入读者服务协议界面，点击<strong>同意</strong>，进入注册开通借阅服务界面，填写相关信息，确认无误后点击<strong>确定</strong>。( 芝麻信用达到 550 分就可以免费办理,相信大家早就达到了吧。)</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E6%B5%99%E6%B1%9F%E5%9B%BE%E4%B9%A6%E9%A6%86%E6%B3%A8%E5%86%8C.jpg" alt=""></p></li><li><p>当然，接下来就不可避免的需要授予权限了，在服务授权界面点击<strong>确认授权</strong>，授权之后就可以得知你是否办证成功了，此时你需要记住你的读者证号，然后点击<strong>立即领取浙江图书馆读者证</strong>，下一个页面看完读者须知后同样点击<strong>立即领取浙江图书馆读者证</strong>，现在去卡包中查看，就有新添加的读者证了。</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E6%B5%99%E6%B1%9F%E5%9B%BE%E4%B9%A6%E9%A6%86%E8%AF%BB%E8%80%85%E8%AF%81.jpg" alt=""></p></li></ul><h4 id="2-用读者证账号密码免费下载论文"><a href="#2-用读者证账号密码免费下载论文" class="headerlink" title="2.用读者证账号密码免费下载论文"></a>2.用读者证账号密码免费下载论文</h4><ul><li><p>浏览器搜索<strong>浙江图书馆</strong>，进入官网首页，点击<strong>您好，请登录!</strong>。读者证号输入你刚刚需要记住的读者证号，密码输入刚设置的密码，即可登录。</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E6%B5%99%E6%B1%9F%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%A6%96%E9%A1%B5.png" alt=""> </p></li><li><p>点击资源栏中的<strong>数字资源</strong>，再选择要检索的数字资源库。以知网为例，给大家讲下选择具体资源库的方法。直接点击首字母<strong>Z</strong>就可找到知网相关资源，点击进入即可。 </p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E6%B5%99%E6%B1%9F%E5%9B%BE%E4%B9%A6%E9%A6%86%E5%AF%BC%E8%88%AA%E6%A0%8F.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E8%B5%84%E6%BA%90%E5%BA%93%E9%80%89%E6%8B%A9.png" alt=""></p></li><li><p>进入知网后，在<strong>快速检索</strong>中输入关键词，如<strong>计算机</strong>，点击左侧<strong>保存</strong>按钮就可以秒下文献了！ (当然你还可以点击这篇文章链接进去下载)</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD.png" alt=""></p></li></ul><h3 id="二、支付宝积分兑换免费课程"><a href="#二、支付宝积分兑换免费课程" class="headerlink" title="二、支付宝积分兑换免费课程"></a>二、支付宝积分兑换免费课程</h3><p>在支付宝搜索 “ <strong>淘宝好学</strong> ”，选择<strong>积分兑好课</strong>，就能看到仅用积分就能兑换课程啦:smile:</p><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/%E6%B7%98%E5%AE%9D%E5%A5%BD%E5%AD%A6.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;一、免费下载全网论文&quot;&gt;&lt;a href=&quot;#一、免费下载全网论文&quot; class=&quot;headerlink&quot; title=&quot;一、免费下载全网论文&quot;&gt;&lt;/a&gt;一、免费下载全网论文&lt;/h3&gt;&lt;p&gt;不是在校大学生需要使用论文资料，如何下载论文呢？:sob:&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>十大经典排序算法（动图演示）</title>
    <link href="http://yoursite.com/2020/06/04/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%EF%BC%88%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA%EF%BC%89/"/>
    <id>http://yoursite.com/2020/06/04/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%EF%BC%88%E5%8A%A8%E5%9B%BE%E6%BC%94%E7%A4%BA%EF%BC%89/</id>
    <published>2020-06-04T11:06:47.000Z</published>
    <updated>2020-06-29T12:21:12.635Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="0、算法概述"><a href="#0、算法概述" class="headerlink" title="0、算法概述"></a>0、算法概述</h3><h4 id="0-1-算法分类"><a href="#0-1-算法分类" class="headerlink" title="0.1 算法分类"></a>0.1 算法分类</h4><p>十种常见排序算法可以分为两大类：</p><ul><li><strong>比较类排序</strong>：通过比较来决定元素间的相对次序，由于其时间复杂度不能突破 O(nlogn)，因此也称为非线性时间比较类排序。</li><li><strong>非比较类排序</strong>：不通过比较来决定元素间的相对次序，它可以突破基于比较排序的时间下界，以线性时间运行，因此也称为线性时间非比较类排序。 <a id="more"></a></li></ul><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%88%86%E7%B1%BB.png" alt="排序算法分类"></p><h4 id="0-2-算法复杂度"><a href="#0-2-算法复杂度" class="headerlink" title="0.2 算法复杂度"></a>0.2 算法复杂度</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E5%A4%8D%E6%9D%82%E5%BA%A6.png" alt="算法复杂度"></p><h4 id="0-3-相关概念"><a href="#0-3-相关概念" class="headerlink" title="0.3 相关概念"></a>0.3 相关概念</h4><ul><li><strong>稳定</strong>：如果 a 原本在 b 前面，而 a=b，排序之后 a 仍然在 b 的前面。</li><li><strong>不稳定</strong>：如果 a 原本在 b 的前面，而 a=b，排序之后 a 可能会出现在 b 的后面。</li><li><strong>时间复杂度</strong>：对排序数据的总的操作次数。反映当 n 变化时，操作次数呈现什么规律。</li><li><strong>空间复杂度：</strong>是指算法在计算机内执行时所需存储空间的度量，它也是数据规模 n 的函数。 </li></ul><h3 id="1、冒泡排序（Bubble-Sort）"><a href="#1、冒泡排序（Bubble-Sort）" class="headerlink" title="1、冒泡排序（Bubble Sort）"></a>1、冒泡排序（Bubble Sort）</h3><p>冒泡排序是一种简单的排序算法。它重复地走访过要排序的数列，一次比较两个元素，如果它们的顺序错误就把它们交换过来。走访数列的工作是重复地进行直到没有再需要交换，也就是说该数列已经排序完成。这个算法的名字由来是因为越小的元素会经由交换慢慢 “浮” 到数列的顶端。 </p><h4 id="1-1-算法描述"><a href="#1-1-算法描述" class="headerlink" title="1.1 算法描述"></a>1.1 算法描述</h4><ul><li>比较相邻的元素。如果第一个比第二个大，就交换它们两个；</li><li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对，这样在最后的元素应该会是最大的数；</li><li>针对所有的元素重复以上的步骤，除了最后一个；</li><li>重复步骤 1~3，直到排序完成。</li></ul><h4 id="1-2-动图演示"><a href="#1-2-动图演示" class="headerlink" title="1.2 动图演示"></a>1.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="冒泡排序动画"></p><h4 id="1-3-代码实现"><a href="#1-3-代码实现" class="headerlink" title="1.3 代码实现"></a>1.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function bubbleSort(arr) &#123;</span><br><span class="line">    varlen &#x3D; arr.length;</span><br><span class="line">    for(vari &#x3D; 0; i &lt; len - 1; i++) &#123;</span><br><span class="line">        for(varj &#x3D; 0; j &lt; len - 1 - i; j++) &#123;</span><br><span class="line">            if(arr[j] &gt; arr[j+1]) &#123;       &#x2F;&#x2F; 相邻元素两两对比</span><br><span class="line">                vartemp &#x3D; arr[j+1];       &#x2F;&#x2F; 元素交换</span><br><span class="line">                arr[j+1] &#x3D; arr[j];</span><br><span class="line">                arr[j] &#x3D; temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2、选择排序（Selection-Sort）"><a href="#2、选择排序（Selection-Sort）" class="headerlink" title="2、选择排序（Selection Sort）"></a>2、选择排序（Selection Sort）</h3><p>选择排序 (Selection-sort) 是一种简单直观的排序算法。它的工作原理：首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。 </p><h4 id="2-1-算法描述"><a href="#2-1-算法描述" class="headerlink" title="2.1 算法描述"></a>2.1 算法描述</h4><p>n 个记录的直接选择排序可经过 n-1 趟直接选择排序得到有序结果。具体算法描述如下：</p><ul><li>初始状态：无序区为 R[1..n]，有序区为空；</li><li>第 i 趟排序 (i=1,2,3…n-1) 开始时，当前有序区和无序区分别为 R[1..i-1]和 R(i..n）。该趟排序从当前无序区中 - 选出关键字最小的记录 R[k]，将它与无序区的第 1 个记录 R 交换，使 R[1..i]和 R[i+1..n)分别变为记录个数增加 1 个的新有序区和记录个数减少 1 个的新无序区；</li><li>n-1 趟结束，数组有序化了。</li></ul><h4 id="2-2-动图演示"><a href="#2-2-动图演示" class="headerlink" title="2.2 动图演示"></a><strong>2.2 动图演示</strong></h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="选择排序动画"></p><h4 id="2-3-代码实现"><a href="#2-3-代码实现" class="headerlink" title="2.3 代码实现"></a>2.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function selectionSort(arr) &#123;</span><br><span class="line">    varlen &#x3D; arr.length;</span><br><span class="line">    varminIndex, temp;</span><br><span class="line">    for(vari &#x3D; 0; i &lt; len - 1; i++) &#123;</span><br><span class="line">        minIndex &#x3D; i;</span><br><span class="line">        for(varj &#x3D; i + 1; j &lt; len; j++) &#123;</span><br><span class="line">            if(arr[j] &lt; arr[minIndex]) &#123;    &#x2F;&#x2F; 寻找最小的数</span><br><span class="line">                minIndex &#x3D; j;                &#x2F;&#x2F; 将最小数的索引保存</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        temp &#x3D; arr[i];</span><br><span class="line">        arr[i] &#x3D; arr[minIndex];</span><br><span class="line">        arr[minIndex] &#x3D; temp;</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-4-算法分析"><a href="#2-4-算法分析" class="headerlink" title="2.4 算法分析"></a>2.4 算法分析</h4><p>表现最稳定的排序算法之一，因为无论什么数据进去都是 O(n2) 的时间复杂度，所以用到它的时候，数据规模越小越好。唯一的好处可能就是不占用额外的内存空间了吧。理论上讲，选择排序可能也是平时排序一般人想到的最多的排序方法了吧。</p><h3 id="3、插入排序（Insertion-Sort）"><a href="#3、插入排序（Insertion-Sort）" class="headerlink" title="3、插入排序（Insertion Sort）"></a>3、插入排序（Insertion Sort）</h3><p>插入排序（Insertion-Sort）的算法描述是一种简单直观的排序算法。它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。</p><h4 id="3-1-算法描述"><a href="#3-1-算法描述" class="headerlink" title="3.1 算法描述"></a>3.1 算法描述</h4><p>一般来说，插入排序都采用 in-place 在数组上实现。具体算法描述如下：</p><ul><li>从第一个元素开始，该元素可以认为已经被排序；</li><li>取出下一个元素，在已经排序的元素序列中从后向前扫描；</li><li>如果该元素（已排序）大于新元素，将该元素移到下一位置；</li><li>重复步骤 3，直到找到已排序的元素小于或者等于新元素的位置；</li><li>将新元素插入到该位置后；</li><li>重复步骤 2~5。</li></ul><h4 id="3-2-动图演示"><a href="#3-2-动图演示" class="headerlink" title="3.2 动图演示"></a>3.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="插入排序动画"> </p><h4 id="3-2-代码实现"><a href="#3-2-代码实现" class="headerlink" title="3.2 代码实现"></a>3.2 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function insertionSort(arr) &#123;</span><br><span class="line">    varlen &#x3D; arr.length;</span><br><span class="line">    varpreIndex, current;</span><br><span class="line">    for(vari &#x3D; 1; i &lt; len; i++) &#123;</span><br><span class="line">        preIndex &#x3D; i - 1;</span><br><span class="line">        current &#x3D; arr[i];</span><br><span class="line">        while(preIndex &gt;&#x3D; 0 &amp;&amp; arr[preIndex] &gt; current) &#123;</span><br><span class="line">            arr[preIndex + 1] &#x3D; arr[preIndex];</span><br><span class="line">            preIndex--;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[preIndex + 1] &#x3D; current;</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-算法分析"><a href="#3-4-算法分析" class="headerlink" title="3.4 算法分析"></a>3.4 算法分析</h4><p>插入排序在实现上，通常采用 in-place 排序（即只需用到 O(1) 的额外空间的排序），因而在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。</p><h3 id="4、希尔排序（Shell-Sort）"><a href="#4、希尔排序（Shell-Sort）" class="headerlink" title="4、希尔排序（Shell Sort）"></a>4、希尔排序（Shell Sort）</h3><p>1959 年 Shell 发明，第一个突破 O(n2) 的排序算法，是简单插入排序的改进版。它与插入排序的不同之处在于，它会优先比较距离较远的元素。希尔排序又叫<strong>缩小增量排序</strong>。</p><h4 id="4-1-算法描述"><a href="#4-1-算法描述" class="headerlink" title="4.1 算法描述"></a>4.1 算法描述</h4><p>先将整个待排序的记录序列分割成为若干子序列分别进行直接插入排序，具体算法描述：</p><ul><li>选择一个增量序列 t1，t2，…，tk，其中 ti&gt;tj，tk=1；</li><li>按增量序列个数 k，对序列进行 k 趟排序；</li><li>每趟排序，根据对应的增量 ti，将待排序列分割成若干长度为 m 的子序列，分别对各子表进行直接插入排序。仅增量因子为 1 时，整个序列作为一个表来处理，表长度即为整个序列的长度。</li></ul><h4 id="4-2-动图演示"><a href="#4-2-动图演示" class="headerlink" title="4.2 动图演示"></a>4.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="希尔排序动画"></p><h4 id="4-3-代码实现"><a href="#4-3-代码实现" class="headerlink" title="4.3 代码实现"></a>4.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 修改于 2019-03-06</span><br><span class="line">function shellSort(arr) &#123;</span><br><span class="line">    varlen &#x3D; arr.length;</span><br><span class="line">    for(vargap &#x3D; Math.floor(len &#x2F; 2); gap &gt; 0; gap &#x3D; Math.floor(gap &#x2F; 2)) &#123;</span><br><span class="line">        &#x2F;&#x2F; 注意：这里和动图演示的不一样，动图是分组执行，实际操作是多个分组交替执行</span><br><span class="line">        for(vari &#x3D; gap; i &lt; len; i++) &#123;</span><br><span class="line">            varj &#x3D; i;</span><br><span class="line">            varcurrent &#x3D; arr[i];</span><br><span class="line">            while(j - gap &gt;&#x3D; 0 &amp;&amp; current &lt; arr[j - gap]) &#123;</span><br><span class="line">                 arr[j] &#x3D; arr[j - gap];</span><br><span class="line">                 j &#x3D; j - gap;</span><br><span class="line">            &#125;</span><br><span class="line">            arr[j] &#x3D; current;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-算法分析"><a href="#4-4-算法分析" class="headerlink" title="4.4 算法分析"></a>4.4 算法分析</h4><p>希尔排序的核心在于间隔序列的设定。既可以提前设定好间隔序列，也可以动态的定义间隔序列。动态定义间隔序列的算法是《算法（第 4 版）》的合著者 Robert Sedgewick 提出的。　</p><h3 id="5、归并排序（Merge-Sort）"><a href="#5、归并排序（Merge-Sort）" class="headerlink" title="5、归并排序（Merge Sort）"></a>5、归并排序（Merge Sort）</h3><p>归并排序是建立在归并操作上的一种有效的排序算法。该算法是采用分治法（Divide and Conquer）的一个非常典型的应用。将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为 2 - 路归并。 </p><h4 id="5-1-算法描述"><a href="#5-1-算法描述" class="headerlink" title="5.1 算法描述"></a>5.1 算法描述</h4><ul><li>把长度为 n 的输入序列分成两个长度为 n/2 的子序列；</li><li>对这两个子序列分别采用归并排序；</li><li>将两个排序好的子序列合并成一个最终的排序序列。</li></ul><h4 id="5-2-动图演示"><a href="#5-2-动图演示" class="headerlink" title="5.2 动图演示"></a>5.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="归并排序动画"></p><h4 id="5-3-代码实现"><a href="#5-3-代码实现" class="headerlink" title="5.3 代码实现"></a>5.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">function mergeSort(arr) &#123;</span><br><span class="line">    varlen &#x3D; arr.length;</span><br><span class="line">    if(len &lt; 2) &#123;</span><br><span class="line">        returnarr;</span><br><span class="line">    &#125;</span><br><span class="line">    varmiddle &#x3D; Math.floor(len &#x2F; 2),</span><br><span class="line">        left &#x3D; arr.slice(0, middle),</span><br><span class="line">        right &#x3D; arr.slice(middle);</span><br><span class="line">    returnmerge(mergeSort(left), mergeSort(right));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function merge(left, right) &#123;</span><br><span class="line">    varresult &#x3D; [];</span><br><span class="line"> </span><br><span class="line">    while(left.length&gt;0 &amp;&amp; right.length&gt;0) &#123;</span><br><span class="line">        if(left[0] &lt;&#x3D; right[0]) &#123;</span><br><span class="line">            result.push(left.shift());</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            result.push(right.shift());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    while(left.length)</span><br><span class="line">        result.push(left.shift());</span><br><span class="line"> </span><br><span class="line">    while(right.length)</span><br><span class="line">        result.push(right.shift());</span><br><span class="line"> </span><br><span class="line">    returnresult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-4-算法分析"><a href="#5-4-算法分析" class="headerlink" title="5.4 算法分析"></a>5.4 算法分析</h4><p>归并排序是一种稳定的排序方法。和选择排序一样，归并排序的性能不受输入数据的影响，但表现比选择排序好的多，因为始终都是 O(nlogn）的时间复杂度。代价是需要额外的内存空间。</p><h3 id="6、快速排序（Quick-Sort）"><a href="#6、快速排序（Quick-Sort）" class="headerlink" title="6、快速排序（Quick Sort）"></a>6、快速排序（Quick Sort）</h3><p>快速排序的基本思想：通过一趟排序将待排记录分隔成独立的两部分，其中一部分记录的关键字均比另一部分的关键字小，则可分别对这两部分记录继续进行排序，以达到整个序列有序。</p><h4 id="6-1-算法描述"><a href="#6-1-算法描述" class="headerlink" title="6.1 算法描述"></a>6.1 算法描述</h4><p>快速排序使用分治法来把一个串（list）分为两个子串（sub-lists）。具体算法描述如下：</p><ul><li>从数列中挑出一个元素，称为 “基准”（pivot）；</li><li>重新排序数列，所有元素比基准值小的摆放在基准前面，所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作；</li><li>递归地（recursive）把小于基准值元素的子数列和大于基准值元素的子数列排序。</li></ul><h4 id="6-2-动图演示"><a href="#6-2-动图演示" class="headerlink" title="6.2 动图演示"></a>6.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="快速排序动画"></p><h4 id="6-3-代码实现"><a href="#6-3-代码实现" class="headerlink" title="6.3 代码实现"></a>6.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">function quickSort(arr, left, right) &#123;</span><br><span class="line">    varlen &#x3D; arr.length,</span><br><span class="line">        partitionIndex,</span><br><span class="line">        left &#x3D;typeofleft !&#x3D;&#39;number&#39;? 0 : left,</span><br><span class="line">        right &#x3D;typeofright !&#x3D;&#39;number&#39;? len - 1 : right;</span><br><span class="line"> </span><br><span class="line">    if(left &lt; right) &#123;</span><br><span class="line">        partitionIndex &#x3D; partition(arr, left, right);</span><br><span class="line">        quickSort(arr, left, partitionIndex-1);</span><br><span class="line">        quickSort(arr, partitionIndex+1, right);</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function partition(arr, left ,right) &#123;    &#x2F;&#x2F; 分区操作</span><br><span class="line">    varpivot &#x3D; left,                     &#x2F;&#x2F; 设定基准值（pivot）</span><br><span class="line">        index &#x3D; pivot + 1;</span><br><span class="line">    for(vari &#x3D; index; i &lt;&#x3D; right; i++) &#123;</span><br><span class="line">        if(arr[i] &lt; arr[pivot]) &#123;</span><br><span class="line">            swap(arr, i, index);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    swap(arr, pivot, index - 1);</span><br><span class="line">    returnindex-1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function swap(arr, i, j) &#123;</span><br><span class="line">    vartemp &#x3D; arr[i];</span><br><span class="line">    arr[i] &#x3D; arr[j];</span><br><span class="line">    arr[j] &#x3D; temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7、堆排序（Heap-Sort）"><a href="#7、堆排序（Heap-Sort）" class="headerlink" title="7、堆排序（Heap Sort）"></a>7、堆排序（Heap Sort）</h3><p>堆排序（Heapsort）是指利用堆这种数据结构所设计的一种排序算法。堆积是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值或索引总是小于（或者大于）它的父节点。</p><h4 id="7-1-算法描述"><a href="#7-1-算法描述" class="headerlink" title="7.1 算法描述"></a>7.1 算法描述</h4><ul><li>将初始待排序关键字序列 (R1,R2….Rn) 构建成大顶堆，此堆为初始的无序区；</li><li>将堆顶元素 R[1]与最后一个元素 R[n]交换，此时得到新的无序区 (R1,R2,……Rn-1) 和新的有序区(Rn), 且满足 R[1,2…n-1]&lt;=R[n]；</li><li>由于交换后新的堆顶 R[1]可能违反堆的性质，因此需要对当前无序区 (R1,R2,……Rn-1) 调整为新堆，然后再次将 R[1]与无序区最后一个元素交换，得到新的无序区 (R1,R2….Rn-2) 和新的有序区(Rn-1,Rn)。不断重复此过程直到有序区的元素个数为 n-1，则整个排序过程完成。</li></ul><h4 id="7-2-动图演示"><a href="#7-2-动图演示" class="headerlink" title="7.2 动图演示"></a>7.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%A0%86%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="堆排序动画"></p><h4 id="7-3-代码实现"><a href="#7-3-代码实现" class="headerlink" title="7.3 代码实现"></a>7.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">varlen;   &#x2F;&#x2F; 因为声明的多个函数都需要数据长度，所以把len设置成为全局变量</span><br><span class="line"> </span><br><span class="line">function buildMaxHeap(arr) &#123;  &#x2F;&#x2F; 建立大顶堆</span><br><span class="line">    len &#x3D; arr.length;</span><br><span class="line">    for(vari &#x3D; Math.floor(len&#x2F;2); i &gt;&#x3D; 0; i--) &#123;</span><br><span class="line">        heapify(arr, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function heapify(arr, i) &#123;    &#x2F;&#x2F; 堆调整</span><br><span class="line">    varleft &#x3D; 2 * i + 1,</span><br><span class="line">        right &#x3D; 2 * i + 2,</span><br><span class="line">        largest &#x3D; i;</span><br><span class="line"> </span><br><span class="line">    if(left &lt; len &amp;&amp; arr[left] &gt; arr[largest]) &#123;</span><br><span class="line">        largest &#x3D; left;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    if(right &lt; len &amp;&amp; arr[right] &gt; arr[largest]) &#123;</span><br><span class="line">        largest &#x3D; right;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    if(largest !&#x3D; i) &#123;</span><br><span class="line">        swap(arr, i, largest);</span><br><span class="line">        heapify(arr, largest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function swap(arr, i, j) &#123;</span><br><span class="line">    vartemp &#x3D; arr[i];</span><br><span class="line">    arr[i] &#x3D; arr[j];</span><br><span class="line">    arr[j] &#x3D; temp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function heapSort(arr) &#123;</span><br><span class="line">    buildMaxHeap(arr);</span><br><span class="line"> </span><br><span class="line">    for(vari &#x3D; arr.length - 1; i &gt; 0; i--) &#123;</span><br><span class="line">        swap(arr, 0, i);</span><br><span class="line">        len--;</span><br><span class="line">        heapify(arr, 0);</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8、计数排序（Counting-Sort）"><a href="#8、计数排序（Counting-Sort）" class="headerlink" title="8、计数排序（Counting Sort）"></a>8、计数排序（Counting Sort）</h3><p>计数排序不是基于比较的排序算法，其核心在于将输入的数据值转化为键存储在额外开辟的数组空间中。 作为一种线性时间复杂度的排序，计数排序要求输入的数据必须是有确定范围的整数。</p><h4 id="8-1-算法描述"><a href="#8-1-算法描述" class="headerlink" title="8.1 算法描述"></a>8.1 算法描述</h4><ul><li>找出待排序的数组中最大和最小的元素；</li><li>统计数组中每个值为 i 的元素出现的次数，存入数组 C 的第 i 项；</li><li>对所有的计数累加（从 C 中的第一个元素开始，每一项和前一项相加）；</li><li>反向填充目标数组：将每个元素 i 放在新数组的第 C(i) 项，每放一个元素就将 C(i) 减去 1。</li></ul><h4 id="8-2-动图演示"><a href="#8-2-动图演示" class="headerlink" title="8.2 动图演示"></a>8.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.gif" alt="计数排序动画"></p><h4 id="8-3-代码实现"><a href="#8-3-代码实现" class="headerlink" title="8.3 代码实现"></a>8.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function countingSort(arr, maxValue) &#123;</span><br><span class="line">    varbucket &#x3D;newArray(maxValue + 1),</span><br><span class="line">        sortedIndex &#x3D; 0;</span><br><span class="line">        arrLen &#x3D; arr.length,</span><br><span class="line">        bucketLen &#x3D; maxValue + 1;</span><br><span class="line"> </span><br><span class="line">    for(vari &#x3D; 0; i &lt; arrLen; i++) &#123;</span><br><span class="line">        if(!bucket[arr[i]]) &#123;</span><br><span class="line">            bucket[arr[i]] &#x3D; 0;</span><br><span class="line">        &#125;</span><br><span class="line">        bucket[arr[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    for(varj &#x3D; 0; j &lt; bucketLen; j++) &#123;</span><br><span class="line">        while(bucket[j] &gt; 0) &#123;</span><br><span class="line">            arr[sortedIndex++] &#x3D; j;</span><br><span class="line">            bucket[j]--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-4-算法分析"><a href="#8-4-算法分析" class="headerlink" title="8.4 算法分析"></a>8.4 算法分析</h4><p>计数排序是一个稳定的排序算法。当输入的元素是 n 个 0 到 k 之间的整数时，时间复杂度是 O(n+k)，空间复杂度也是 O(n+k)，其排序速度快于任何比较排序算法。当 k 不是很大并且序列比较集中时，计数排序是一个很有效的排序算法。</p><h3 id="9、桶排序（Bucket-Sort）"><a href="#9、桶排序（Bucket-Sort）" class="headerlink" title="9、桶排序（Bucket Sort）"></a>9、桶排序（Bucket Sort）</h3><p>桶排序是计数排序的升级版。它利用了函数的映射关系，高效与否的关键就在于这个映射函数的确定。桶排序 (Bucket sort) 的工作的原理：假设输入数据服从均匀分布，将数据分到有限数量的桶里，每个桶再分别排序（有可能再使用别的排序算法或是以递归方式继续使用桶排序进行排）。</p><h4 id="9-1-算法描述"><a href="#9-1-算法描述" class="headerlink" title="9.1 算法描述"></a>9.1 算法描述</h4><ul><li>设置一个定量的数组当作空桶；</li><li>遍历输入数据，并且把数据一个一个放到对应的桶里去；</li><li>对每个不是空的桶进行排序；</li><li>从不是空的桶里把排好序的数据拼接起来。 </li></ul><h4 id="9-2-图片演示"><a href="#9-2-图片演示" class="headerlink" title="9.2 图片演示"></a>9.2 图片演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%A1%B6%E6%8E%92%E5%BA%8F%E5%8A%A8%E7%94%BB.png" alt="桶排序动画"></p><h4 id="9-3-代码实现"><a href="#9-3-代码实现" class="headerlink" title="9.3 代码实现"></a>9.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">function bucketSort(arr, bucketSize) &#123;</span><br><span class="line">    if(arr.length &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">      returnarr;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    vari;</span><br><span class="line">    varminValue &#x3D; arr[0];</span><br><span class="line">    varmaxValue &#x3D; arr[0];</span><br><span class="line">    for(i &#x3D; 1; i &lt; arr.length; i++) &#123;</span><br><span class="line">      if(arr[i] &lt; minValue) &#123;</span><br><span class="line">          minValue &#x3D; arr[i];               &#x2F;&#x2F; 输入数据的最小值</span><br><span class="line">      &#125;elseif(arr[i] &gt; maxValue) &#123;</span><br><span class="line">          maxValue &#x3D; arr[i];               &#x2F;&#x2F; 输入数据的最大值</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    &#x2F;&#x2F; 桶的初始化</span><br><span class="line">    varDEFAULT_BUCKET_SIZE &#x3D; 5;           &#x2F;&#x2F; 设置桶的默认数量为5</span><br><span class="line">    bucketSize &#x3D; bucketSize || DEFAULT_BUCKET_SIZE;</span><br><span class="line">    varbucketCount &#x3D; Math.floor((maxValue - minValue) &#x2F; bucketSize) + 1;  </span><br><span class="line">    varbuckets &#x3D;newArray(bucketCount);</span><br><span class="line">    for(i &#x3D; 0; i &lt; buckets.length; i++) &#123;</span><br><span class="line">        buckets[i] &#x3D; [];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    &#x2F;&#x2F; 利用映射函数将数据分配到各个桶中</span><br><span class="line">    for(i &#x3D; 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        buckets[Math.floor((arr[i] - minValue) &#x2F; bucketSize)].push(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    arr.length &#x3D; 0;</span><br><span class="line">    for(i &#x3D; 0; i &lt; buckets.length; i++) &#123;</span><br><span class="line">        insertionSort(buckets[i]);                     &#x2F;&#x2F; 对每个桶进行排序，这里使用了插入排序</span><br><span class="line">        for(varj &#x3D; 0; j &lt; buckets[i].length; j++) &#123;</span><br><span class="line">            arr.push(buckets[i][j]);                     </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-4-算法分析"><a href="#9-4-算法分析" class="headerlink" title="9.4 算法分析"></a>9.4 算法分析</h4><p>桶排序最好情况下使用线性时间 O(n)，桶排序的时间复杂度，取决与对各个桶之间数据进行排序的时间复杂度，因为其它部分的时间复杂度都为 O(n)。很显然，桶划分的越小，各个桶之间的数据越少，排序所用的时间也会越少。但相应的空间消耗就会增大。 </p><h3 id="10、基数排序（Radix-Sort）"><a href="#10、基数排序（Radix-Sort）" class="headerlink" title="10、基数排序（Radix Sort）"></a>10、基数排序（Radix Sort）</h3><p>基数排序是按照低位先排序，然后收集；再按照高位排序，然后再收集；依次类推，直到最高位。有时候有些属性是有优先级顺序的，先按低优先级排序，再按高优先级排序。最后的次序就是高优先级高的在前，高优先级相同的低优先级高的在前。</p><h4 id="10-1-算法描述"><a href="#10-1-算法描述" class="headerlink" title="10.1 算法描述"></a>10.1 算法描述</h4><ul><li>取得数组中的最大数，并取得位数；</li><li>arr 为原始数组，从最低位开始取每个位组成 radix 数组；</li><li>对 radix 进行计数排序（利用计数排序适用于小范围数的特点）；</li></ul><h4 id="10-2-动图演示"><a href="#10-2-动图演示" class="headerlink" title="10.2 动图演示"></a>10.2 动图演示</h4><p><img src="https://cdn.jsdelivr.net/gh/braveyouth/figurebed/%E5%8D%81%E5%A4%A7%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F.gif" alt="基数排序动画"></p><h4 id="10-3-代码实现"><a href="#10-3-代码实现" class="headerlink" title="10.3 代码实现"></a>10.3 代码实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">varcounter &#x3D; [];</span><br><span class="line">function radixSort(arr, maxDigit) &#123;</span><br><span class="line">    varmod &#x3D; 10;</span><br><span class="line">    vardev &#x3D; 1;</span><br><span class="line">    for(vari &#x3D; 0; i &lt; maxDigit; i++, dev *&#x3D; 10, mod *&#x3D; 10) &#123;</span><br><span class="line">        for(varj &#x3D; 0; j &lt; arr.length; j++) &#123;</span><br><span class="line">            varbucket &#x3D; parseInt((arr[j] % mod) &#x2F; dev);</span><br><span class="line">            if(counter[bucket]&#x3D;&#x3D;null) &#123;</span><br><span class="line">                counter[bucket] &#x3D; [];</span><br><span class="line">            &#125;</span><br><span class="line">            counter[bucket].push(arr[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        varpos &#x3D; 0;</span><br><span class="line">        for(varj &#x3D; 0; j &lt; counter.length; j++) &#123;</span><br><span class="line">            varvalue &#x3D;null;</span><br><span class="line">            if(counter[j]!&#x3D;null) &#123;</span><br><span class="line">                while((value &#x3D; counter[j].shift()) !&#x3D;null) &#123;</span><br><span class="line">                      arr[pos++] &#x3D; value;</span><br><span class="line">                &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    returnarr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-4-算法分析"><a href="#10-4-算法分析" class="headerlink" title="10.4 算法分析"></a>10.4 算法分析</h4><p>基数排序基于分别排序，分别收集，所以是稳定的。但基数排序的性能比桶排序要略差，每一次关键字的桶分配都需要 O(n) 的时间复杂度，而且分配之后得到新的关键字序列又需要 O(n) 的时间复杂度。假如待排数据可以分为 d 个关键字，则基数排序的时间复杂度将是 O(d*2n) ，当然 d 要远远小于 n，因此基本上还是线性级别的。</p><p>基数排序的空间复杂度为 O(n+k)，其中 k 为桶的数量。一般来说 n&gt;&gt;k，因此额外空间需要大概 n 个左右。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;0、算法概述&quot;&gt;&lt;a href=&quot;#0、算法概述&quot; class=&quot;headerlink&quot; title=&quot;0、算法概述&quot;&gt;&lt;/a&gt;0、算法概述&lt;/h3&gt;&lt;h4 id=&quot;0-1-算法分类&quot;&gt;&lt;a href=&quot;#0-1-算法分类&quot; class=&quot;headerlink&quot; title=&quot;0.1 算法分类&quot;&gt;&lt;/a&gt;0.1 算法分类&lt;/h4&gt;&lt;p&gt;十种常见排序算法可以分为两大类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;比较类排序&lt;/strong&gt;：通过比较来决定元素间的相对次序，由于其时间复杂度不能突破 O(nlogn)，因此也称为非线性时间比较类排序。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;非比较类排序&lt;/strong&gt;：不通过比较来决定元素间的相对次序，它可以突破基于比较排序的时间下界，以线性时间运行，因此也称为线性时间非比较类排序。
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="算法" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>studio 3T 两种破解教程</title>
    <link href="http://yoursite.com/2020/05/15/studio-3T-%E4%B8%A4%E7%A7%8D%E7%A0%B4%E8%A7%A3%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2020/05/15/studio-3T-%E4%B8%A4%E7%A7%8D%E7%A0%B4%E8%A7%A3%E6%95%99%E7%A8%8B/</id>
    <published>2020-05-15T13:40:07.000Z</published>
    <updated>2020-05-15T15:36:26.248Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="解决studio-3T时间到期的两种方法"><a href="#解决studio-3T时间到期的两种方法" class="headerlink" title="解决studio 3T时间到期的两种方法"></a>解决studio 3T时间到期的两种方法</h2><blockquote><p>此教程并非真正破解，而是通过重置 studio 3t 的试用时间解决的。</p></blockquote><a id="more"></a><h3 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h3><ul><li><p>按住<code>win + r</code> 键输入 <code>regedit</code></p></li><li><p>找到以下路径<br><code>HKEY_USERS\S-1-5-21-xxxxxxxxxxxxxx\SOFTWARE\JavaSoft\Prefs\3t\mongochef\enterprise</code></p></li><li><p>将除了 <code>installation-date-2019.2.1</code>（这个是软件安装日期的时间戳）<strong>这个项以外的项数据修改为空</strong>，再次打开软件就又是 30 天试用了  </p></li></ul><h3 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法"></a>第二种方法</h3><ul><li><p>创建一个文本文档</p></li><li><p>输入以下代码</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">ECHO 重置Studio 3T的使用日期......</span><br><span class="line">FOR /f "tokens=1,2,* " %%i IN ('reg query "HKEY_CURRENT_USER\Software\JavaSoft\Prefs\3t\mongochef\enterprise" ^| find /V "installation" ^| find /V "HKEY"') DO ECHO yes | reg add "HKEY_CURRENT_USER\Software\JavaSoft\Prefs\3t\mongochef\enterprise" /v %%i /t REG_SZ /d ""</span><br><span class="line">ECHO 重置完成, 按任意键退出......</span><br><span class="line"><span class="meta">pause&gt;</span><span class="bash">nul</span></span><br><span class="line">exit</span><br></pre></td></tr></table></figure><ul><li><p>将文件命名为<code>studio3t.bat</code></p></li><li><p>将<code>studio3t.bat</code>文件添加到以下路径<br><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs</code></p></li><li><p>运行 studio 3T 即可延长使用期限</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;解决studio-3T时间到期的两种方法&quot;&gt;&lt;a href=&quot;#解决studio-3T时间到期的两种方法&quot; class=&quot;headerlink&quot; title=&quot;解决studio 3T时间到期的两种方法&quot;&gt;&lt;/a&gt;解决studio 3T时间到期的两种方法&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;此教程并非真正破解，而是通过重置 studio 3t 的试用时间解决的。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="开发软件" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>健康的作息时间表</title>
    <link href="http://yoursite.com/2020/05/02/%E5%85%A8%E7%90%83%E5%85%AC%E8%AE%A4%E6%9C%80%E5%81%A5%E5%BA%B7%E7%9A%84%E4%BD%9C%E6%81%AF%E6%97%B6%E9%97%B4%E8%A1%A8/"/>
    <id>http://yoursite.com/2020/05/02/%E5%85%A8%E7%90%83%E5%85%AC%E8%AE%A4%E6%9C%80%E5%81%A5%E5%BA%B7%E7%9A%84%E4%BD%9C%E6%81%AF%E6%97%B6%E9%97%B4%E8%A1%A8/</id>
    <published>2020-05-02T02:34:34.000Z</published>
    <updated>2020-05-02T09:12:45.703Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>下面是全球公认最健康的作息时间表，你值得拥有！</p><a id="more"></a><h3 id="7-00-起床"><a href="#7-00-起床" class="headerlink" title="7:00    起床"></a>7:00    起床</h3><p>迎着清晨的阳光起床。一杯温水是早起之后的必需品，能让你获得一天最好的开始。</p><p><img src="https://qqpublic.qpic.cn/qq_public/0/0-2229531210-75463C8A7BB7FD51561AA7E241451669/900" alt=""></p><h3 id="7-20-8-00-吃早饭"><a href="#7-20-8-00-吃早饭" class="headerlink" title="7:20-8:00    吃早饭"></a>7:20-8:00    吃早饭</h3><p>你需要营养全面而丰富的早餐。一顿优质的早餐，能让你一整天都充满活力。</p><p><img src="https://qqpublic.qpic.cn/qq_public/0/0-3006431292-DC47FFDD6807F2150236DF4464F9E428/900" alt=""></p><h3 id="8-30-9-00-避免剧烈运动"><a href="#8-30-9-00-避免剧烈运动" class="headerlink" title="8:30-9:00    避免剧烈运动"></a>8:30-9:00    避免剧烈运动</h3><p>早上是人体免疫系统最弱的时候，不要做剧烈的运动，走路上班是很好的选择，健康又惬意。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2498594716-52EED3E9DAB6B73B6736508CF00A0E43/0?fmt=jpg&size=18&h=360&w=640&ppv=1" alt=""></p><h3 id="9-00-10-00-做困难性工作"><a href="#9-00-10-00-做困难性工作" class="headerlink" title="9:00-10:00    做困难性工作"></a>9:00-10:00    做困难性工作</h3><p>上午，人脑最清醒犀利，应该用来做最有难度的事。比如攻克工作的难题，给复杂的报告列提纲等等，充分利用好上午清醒的大脑。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2821994936-30E6B86D9F0717CB59E1A7C4279DA02F/0?fmt=jpg&size=16&h=360&w=640&ppv=1" alt="">  </p><h3 id="10-30-让眼睛休息一下"><a href="#10-30-让眼睛休息一下" class="headerlink" title="10:30    让眼睛休息一下"></a>10:30    让眼睛休息一下</h3><p>一晃就十点半了，起来走动走动，眺望一下远方，做一做眼保健操，让眼睛舒缓舒缓。  </p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2593181746-7096933C12220814D6BACC8E60D75819/0?fmt=jpg&size=13&h=360&w=640&ppv=1" alt=""></p><h3 id="11-00-吃点水果"><a href="#11-00-吃点水果" class="headerlink" title="11:00    吃点水果"></a>11:00    吃点水果</h3><p>上午工作得差不多了，该吃点水果了。上午是一天吃水果的最佳时机，因为上午人体最适合吸收水果里的营养。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2821155990-CD6ED1A1C88F33A25D112D51ABAF2CD5/0?fmt=jpg&size=12&h=360&w=640&ppv=1" alt=""></p><h3 id="12-00-12-30-午餐"><a href="#12-00-12-30-午餐" class="headerlink" title="12:00-12:30    午餐"></a>12:00-12:30    午餐</h3><p>午餐要吃饱，中午应该补充足够的蛋白质，豆类食品是最佳选择。虽然是午饭，久坐办公室的人也不要吃得太油腻。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2465346863-07413ECBB2DADBF056E348A0AD9A09D3/0?fmt=jpg&size=14&h=360&w=640&ppv=1" alt=""></p><h3 id="13-00-14-00-午睡"><a href="#13-00-14-00-午睡" class="headerlink" title="13:00-14:00    午睡"></a>13:00-14:00    午睡</h3><p>午饭后的时间很宝贵，最好用来小睡一觉。有的人喜欢在中午网上购物或者是打激烈的游戏，这反而会让大脑处于过度紧张的状态，造成下午身体的疲惫。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2854960333-A59C8DEB6EE9F43848E12D0E6955E7C3/0?fmt=jpg&size=13&h=360&w=640&ppv=1" alt=""></p><h3 id="14-00-16-00-做创意性工作"><a href="#14-00-16-00-做创意性工作" class="headerlink" title="14:00-16:00    做创意性工作"></a>14:00-16:00    做创意性工作</h3><p>午后是人思维最活跃的时间，非常适合做一些创意性的工作。想一想工作中的创新，即使是微小的改善，日积月累也会有巨大的成就。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2594154900-30323458FC4D49163895D1520D7CD1E1/0?fmt=jpg&size=16&h=360&w=640&ppv=1" alt="">  </p><h3 id="16-00-喝杯酸奶"><a href="#16-00-喝杯酸奶" class="headerlink" title="16:00    喝杯酸奶"></a>16:00    喝杯酸奶</h3><p>四点左右，喝杯酸奶，能补充身体流失的血糖。马上将要投入到一天里最密集的工作中了。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2566162499-52E792A0178F7914A111CEE1C7F01973/0?fmt=jpg&size=13&h=360&w=640&ppv=1" alt=""></p><h3 id="16-10-19-00-做细致性工作"><a href="#16-10-19-00-做细致性工作" class="headerlink" title="16:10-19:00    做细致性工作"></a>16:10-19:00    做细致性工作</h3><p>四点到七点，身体和大脑都处于一天的巅峰状态，这时候我们应该做细致而密集的工作。做完这些别着急回家，  </p><p>花 10 分钟总结一下当天的工作：</p><p>今天收获了哪些好创意</p><p>积累了哪些经验</p><p>学习了什么新工具</p><p>验证了什么想法</p><p>……</p><p>每天 10 分钟反思，大器必将早成！  </p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2352655579-6B318663F2D9E875C6226676FED4E9F5/0?fmt=jpg&size=16&h=360&w=640&ppv=1" alt=""></p><h3 id="19-00-最佳的运动时间"><a href="#19-00-最佳的运动时间" class="headerlink" title="19:00    最佳的运动时间"></a>19:00    最佳的运动时间</h3><p>下班之后稍微吃点东西，晚饭不要吃太多，三分饱即可。晚饭后稍微歇一会儿再开始运动。先散步，再慢跑，是非常健康的运动方式。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-2974698069-25AE66C7605EEE5F8A148793725DCA79/0?fmt=jpg&size=15&h=360&w=640&ppv=1" alt=""></p><h3 id="20-00-看电视或看书"><a href="#20-00-看电视或看书" class="headerlink" title="20:00    看电视或看书"></a>20:00    看电视或看书</h3><p>运动之后可以看看电视，或打开你阅读计划中的书放松阅读。最好的选择还是在娱乐休闲中延绵不绝地思考工作，这样会碰撞出意想不到的火花。  </p><p>劳逸结合的精髓就是：休闲的时候还有一根弦在牵挂工作，稍有灵感迸发就立刻抓住。</p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-3012196757-2B146EBE02449840F364A0E24574E8AC/0?fmt=jpg&size=14&h=360&w=640&ppv=1" alt=""></p><h3 id="22-00-洗个热水澡"><a href="#22-00-洗个热水澡" class="headerlink" title="22:00    洗个热水澡"></a>22:00    洗个热水澡</h3><p>时间差不多就该洗个澡了，让身体彻底舒缓下来，洗去一天的疲惫。  </p><p><img src="http://qqpublic.qpic.cn/qq_public/0/0-3163399326-A2F9AB0CA64042E2EFC922B98DDA1FEC/0?fmt=jpg&size=17&h=360&w=640&ppv=1" alt=""></p><h3 id="23-00-上床睡觉"><a href="#23-00-上床睡觉" class="headerlink" title="23:00    上床睡觉"></a>23:00    上床睡觉</h3><p>人体的各个器官都开始处于休息期了，不要违背身体的自然规律，放松睡一个好觉，明天又是美好的一天！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;下面是全球公认最健康的作息时间表，你值得拥有！&lt;/p&gt;
    
    </summary>
    
    
      <category term="生活" scheme="http://yoursite.com/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="作息时间表" scheme="http://yoursite.com/tags/%E4%BD%9C%E6%81%AF%E6%97%B6%E9%97%B4%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>网络资源使用简明指南之电子书篇</title>
    <link href="http://yoursite.com/2020/04/17/%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%E7%AE%80%E6%98%8E%E6%8C%87%E5%8D%97%E4%B9%8B%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AF%87/"/>
    <id>http://yoursite.com/2020/04/17/%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%E7%AE%80%E6%98%8E%E6%8C%87%E5%8D%97%E4%B9%8B%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AF%87/</id>
    <published>2020-04-17T04:15:06.000Z</published>
    <updated>2020-06-22T12:57:53.954Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>书写出来并不是为了藏在高墙之后，而是为了向世界传播，激励和启发世人。<br>知识不是一小部分人的特权，是应该自由顺畅流向每一个需要它的人。 <a id="more"></a></p><blockquote><p>信息就是力量。但就像所有力量一样，有些人只想占为己有。<br>世界上所有的科学和文化遗产，已在书籍和期刊上发布了数个世纪，正渐渐地被少数私有的公司数字化并上锁。<br>那些能够获取这些资源的人，你有责任将它与世界分享。                                                                                                                                                 – <strong>亚伦·希勒尔·斯沃茨</strong> </p></blockquote><h3 id="电子书下载类"><a href="#电子书下载类" class="headerlink" title="电子书下载类"></a>电子书下载类</h3><table><thead><tr><th>图标</th><th>名称</th><th>简介</th></tr></thead><tbody><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://sobooks.cc/"></td><td><a href="https://sobooks.cc/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">sobooks</a></td><td>优质电子书资源免费下载</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://www.jiumodiary.com/"></td><td><a href="https://www.jiumodiary.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">鸠摩搜书</a></td><td>很受欢迎的电子书搜索引擎</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://www.zqbook.top/"></td><td><a href="https://www.zqbook.top/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">智奇搜书</a></td><td>电子书搜索平台</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=http://kindle.archiew.top/"></td><td><a href="http://kindle.archiew.top/" rel="noopener norefferrer" target="_blank">书舟网</a></td><td>聚合多个电子书网站，多达 14 万册资源</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=http://neikuw.com/"></td><td><a href="http://neikuw.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">内酷网</a></td><td>电子书网站，数据丰富，提供多种格式，并提供合集下载</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://book.51read.site/"></td><td><a href="https://book.51read.site/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">Kindle电子书</a></td><td>电子书网站，超过 6 万本书，下载没有任何限制。</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=http://ebook.name/"></td><td><a href="http://ebook.name/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">采书</a></td><td>聚合多个电子书网站，帮你更快的找到你要的资源。</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://yabook.org/"></td><td><a href="https://yabook.org/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">雅书</a></td><td>PDF电子书学习下载站</td></tr><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://shuayouxi.cn/"></td><td><a href="https://shuayouxi.cn/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">超级书库</a></td><td>电子书网站</td></tr></tbody></table><h3 id="电子书推荐类"><a href="#电子书推荐类" class="headerlink" title="电子书推荐类"></a>电子书推荐类</h3><table><thead><tr><th>图标</th><th>名称</th><th>简介</th></tr></thead><tbody><tr><td><img src="https://www.google.cn/s2/favicons?domain=https://haoshu100.com/"></td><td><a href="https://haoshu100.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">好书推荐</a></td><td>书单推荐，好书推荐排行榜。</td></tr><tr><td><img class="" src="https://www.google.cn/s2/favicons?domain=https://bookfere.com/"></td><td><a href="https://bookfere.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">书伴</a></td><td>阅读工具，提供与阅读相关的工具及技巧</td></tr></tbody></table><h3 id="电子书杂志类"><a href="#电子书杂志类" class="headerlink" title="电子书杂志类"></a>电子书杂志类</h3><table><thead><tr><th>图标</th><th>名称</th><th>简介</th></tr></thead><tbody><tr><td><img src="https://www.google.cn/s2/favicons?domain=http://www.rensheng5.com/"></td><td><a href="http://www.rensheng5.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">人生屋</a></td><td>聚合青年文摘、读者、意林、故事会及其他哲理或寓言文章</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;书写出来并不是为了藏在高墙之后，而是为了向世界传播，激励和启发世人。&lt;br&gt;知识不是一小部分人的特权，是应该自由顺畅流向每一个需要它的人。
    
    </summary>
    
    
      <category term="网络资源使用" scheme="http://yoursite.com/categories/%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8/"/>
    
      <category term="简明指南" scheme="http://yoursite.com/categories/%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8/%E7%AE%80%E6%98%8E%E6%8C%87%E5%8D%97/"/>
    
    
      <category term="电子书" scheme="http://yoursite.com/tags/%E7%94%B5%E5%AD%90%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>一个字节的奇幻之旅</title>
    <link href="http://yoursite.com/2020/04/14/%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82%E7%9A%84%E5%A5%87%E5%B9%BB%E4%B9%8B%E6%97%85/"/>
    <id>http://yoursite.com/2020/04/14/%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82%E7%9A%84%E5%A5%87%E5%B9%BB%E4%B9%8B%E6%97%85/</id>
    <published>2020-04-14T04:46:19.000Z</published>
    <updated>2020-04-14T05:14:18.925Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>大家好，给大家介绍一下，我是一个字节。相比于你们人类据说即将达到的百岁人生的寿命，我的一生简直不直一提（我只能存活零点几个毫秒）。<a id="more"></a></p><p>也许只有那些码农才会了解我，而且也只有一部分码农。那些整天做业务的猿们想来也不会真正的了解我，更别提人类其他行业的人了。</p><p>我不甘心，虽然我微不足道，但是我对人类的贡献实在是太大了。没有我的世界根本无法想像：不能开微信，不能刷微博，不能听网易云音乐，不能刷抖音，不能上天猫，所有和网络相关的活动都无法进行。</p><p>所以，今天我要讲讲我的一生，让更多的人知道我的存在，知道我的故事，也为证明自己曾经存在过吧。</p><p><strong>1、诞生</strong></p><p>我的主人是一个在西二旗知名互联网公司上班的程序猿，过着 1095（注：早 10 点晚 9 点，一周 5 天工作）的生活，很少能在晚霞中回家，自然也说不出 “落霞与孤鹜齐飞” 那样的句子。</p><p>这一天，他 9 点半到家，第一件事打开电脑，熟练地启动 chrome 浏览器，在地址栏敲下一个 z 字符，我所有的故事就从这里开始。</p><p>当主人按下键盘上的 z 键时，系统了产生一个中断信号，通知 CPU 过来读取键盘输入，CPU 读取到 z 后，将 z 发送给 chrome 浏览器, chrome 收到后，将 z 显示到浏览器的地址栏上，同时后台搜索主人平时访问过的地址，排名第一的 <a href="https://www.zhihu.com" target="_blank" rel="noopener">https://www.zhihu.com</a> 被快速补全了。</p><p>这时主人熟练地按下了回车键，chrome 收到指令后，进行了一顿操作，在这电光火石之间，我诞生了，同时诞生的还有我的字节兄弟们。</p><p><strong>2、上路</strong></p><p>话说 Chorme 老大哥接收到了 URL 后，首先拆解成自己能看懂的东西。 <a href="https://www.zhihu.com" target="_blank" rel="noopener">https://www.zhihu.com</a> 会被拆解成三部分： https、 <a href="http://www.zhihu.com、" target="_blank" rel="noopener">www.zhihu.com、</a> /。</p><p>https 表示协议类型，通过这个 Chorme 老大哥知道他接下来该如何与远方的网站服务器通信； <a href="http://www.zhihu.com" target="_blank" rel="noopener">www.zhihu.com</a> 表示主机名，就是 Chorme 老大哥要通信的对象了；第三部分则是它要向服务器要的内容（注：这里表明是空，实际上隐含的表示主目录文件的概念）。</p><p>有了这三项， Chorme 老大哥就能从服务器那里获取它想要的内容了，从而展示给我的主人。</p><p>Chorme 老大哥跑到 HTTP 数据包生产车间，哼哧哼哧地倒腾半天，生产出了一个 HTTP 数据包（注：忽略 https, 简单起见当成 http），这个数据包实际上就是我和我的一群字节兄弟们，我们挤在一个集装箱内，熙熙攘攘。</p><p>我们马上就要搭乘 IP 列车到远方的服务器，见识外面的世界了。集装箱被装上了 TCP 专车，它将带我们来到列车站。 TCP 专车很安全也很舒适，我从集装箱的缝隙中看到车前贴上了车牌： 80.</p><p>到了车站， TCP 专车直接开到了列车上。这样也好， IP 列车上很脏，我们坐在专车上更好。 只是列车还不知道具体要去哪，所以我们就只能先在列车上等着了。</p><p>不对啊，列车应该去 <a href="http://www.zhihu.com" target="_blank" rel="noopener">www.zhihu.com</a> 这个网站，不是已经知道了吗？对的，但是 IP 列车挺笨的，也挺古板的，不认识这些字母。它只认识数字，人类称之为 ip.</p><p>Chorme 老大哥也有点抱怨，人类真是笨，连个 ip 都记不住，非得用域名来上网。害我还得拿着这个域名去问 DNS 老大爷，它知道所有域名对应的 ip.</p><p>这不， Chorme 老大哥又跑到另外一个车间—— DNS 数据包生产车间里倒腾出了一个 DNS 数据包，当然还是一群字节兄弟们，不过这里的兄弟就少一些了。它们在集装箱里叽叽喳喳，被装上了 UDP 敞篷车，车虽然很快，但不太安全，我这些兄弟们坐在上面，提心吊胆，生怕掉下去，因为掉下去，就永远消失了。</p><p>UDP 敞篷车也直接开到了 IP 列车上，车前贴了车牌：53.</p><p>这回 Chrome 老大哥直接从 操作系统大佬那要到了 DNS 老大爷的 ip, 贴到了 IP 列车的车头， IP 列车马上全速启动，载着我这些字节兄弟，赶到了 DNS 老大爷的城堡， UDP 敞篷车开下列车，按照车牌号 53 找到了 DNS 老大爷的住处。从它那拿到了 <a href="http://www.zhihu.com" target="_blank" rel="noopener">www.zhihu.com</a> 对应的 ip.</p><p>DNS 老大爷学问渊博，他也很仗义，从自己城堡里的 DNS 数据包生产车间造出了 DNS 响应包，包里也是我这些字节兄弟们，它们拿着重要的资料数据—— <a href="http://www.zhihu.com" target="_blank" rel="noopener">www.zhihu.com</a> 对应的 ip, 坐上了另一趟返程的 IP 列车，而列车的终点就是我现在所在的地方。当然了，他们是由另一辆 UDP 敞篷车载着他们回来的。</p><p>Chorme 老大哥在车间接见了这些兄弟，非常感动。因为他们带回了 <a href="http://www.zhihu.com" target="_blank" rel="noopener">www.zhihu.com</a> 对应的 ip. 那些兄弟争先恐后的报告自己知道的东西，有些兄弟报告 1, 有些兄弟报告 0, Chorme 老大哥非常有经验，它把这些消息合并起来了，最终得到了它想要的 ip: 118.89.204.192.</p><p>Chorme 老大哥拿着这个 ip 来到了我所在的列车前面，我激动地要叫起来了：终于我要出发了！它熟练地把 118.89.204.192 贴到了列车的前面，马上列车就开动了，我上路了。</p><p>IP 列车的列车长在掌管着车头的方向，决定着我们的命运走向。路网非常复杂，而车头上只有一个 ip 地址，根本没告诉列车长应该走哪条路。这不难，富有经验的列车长根据车头的 ip 地址查到了下一个大站（路由器）的地址，之后再根据这个大站地址查到（ARP 协议）途经的下一个小站（交换机或集线器）应该走的轨道。在每个小站，对照这个大站地址，列车长就知道该走哪条路。搞定！</p><p>经过了很多的小站，我们终于到了下一个大站了。站点的工作人员看着我们车头前的 ip 地址，查了下表（路由表）告诉我们下一个大站的地址，并且告诉我们途径的下一个小站应该走哪条轨道。列车长就这样，一路拿这张表，顺利地把我们带到了终点： 118.89.204.192.</p><p>不过，刚刚就在到终点的前一刻，列车被拦住了，一群荷枪实弹的警卫冲上来了，一些胆小的字节兄弟们都哭了，我也是屏气凝声。他们先是查看了车头的 ip 地址，再查看了列车长手里的表，还看了下我们的 TCP 专车的车牌。很快就放行了，虚惊一场！</p><p><strong>3、新生</strong></p><p>到了终点站后，列车首先停下接受工作人员的检查。列车长出示了他手里的表，对了一下表上标注的下一站地址确实是：知乎。接着又看了下列车头部标注的 ip 地址，就算检查通过了，第一关很轻松。</p><p>接下来，我们坐的 TCP 专车开下列车了。进了一个 TCP 车牌检查站，工作人员看了下车牌号 80, 也挥手示意我们通过。</p><p>接着我们都下车走进了 主页车间，进去后，我们先按我们身上的标号排好了位置，工作人员将我们每个人所代表的信息进行了聚拢。得到了各种关于主人的信息，比如他所用的浏览器的版本，cookie 等等信息，我知道，我们的使命完成了。果然，一道光闪过，我们都消失了，完成了我们光荣的一生。</p><p>主页车间领导马上下达生产命令：1 组去仓库拉取最新话题，2 组去商业中心获取今天的广告主信息……</p><p>很快，各组都完成了任务，车间在一阵轰鸣过后，新的一批字节兄弟诞生了，他们带着这些话题、广告信息，和我们当年出生的时候一样，熙熙攘攘。但是我知道，我获得了新生。</p><p><strong>4、归家</strong></p><p>像我们当年一样，这些新出生的字节兄弟依次坐上了 TCP 专车， IP 列车一路跋涉，去往我出发的地方，那是我梦开始的地方。</p><p>我所经历的，他们未曾少过一分。</p><p><strong>5、定格</strong></p><p>Chrome 老大哥终于等来了这些字节兄弟，在他们排好队后，老大哥看清了字节兄弟们代表的内容：话题2020魔幻剧连载，川建国变形记，切尔诺贝利再现危机，全球化面临的挑战，植发广告……</p><p>这些是 Chrome 老大哥最擅长的事情，分分钟将他们显示在了网页上。字节兄弟们终于完成了使命，定格在了 retina 屏幕上。</p><p>我的主人点开第一话题后，看了一会儿。然后瞅到了植发广告，他偷偷地开启了隐身模式，仔细地研究了起来……</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;大家好，给大家介绍一下，我是一个字节。相比于你们人类据说即将达到的百岁人生的寿命，我的一生简直不直一提（我只能存活零点几个毫秒）。
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="有趣的" scheme="http://yoursite.com/tags/%E6%9C%89%E8%B6%A3%E7%9A%84/"/>
    
  </entry>
  
  <entry>
    <title>计算机科学与技术是什么</title>
    <link href="http://yoursite.com/2020/04/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF%E6%98%AF%E4%BB%80%E4%B9%88/"/>
    <id>http://yoursite.com/2020/04/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF%E6%98%AF%E4%BB%80%E4%B9%88/</id>
    <published>2020-04-14T03:17:11.000Z</published>
    <updated>2020-04-14T04:06:35.318Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>什么是计算机科学与技术？</p><p>百度百科：</p><blockquote><p>计算机科学与技术是研究计算机的设计与制造，并利用计算机进行有关的信息表示、收发、存储、处理、控制等的理论方法和技术的学科。</p></blockquote><a id="more"></a><p>维基百科：</p><blockquote><p>Computer science is the theory, experimentation, and engineering that form the basis for the design and use of computers. It involves the study of algorithms that process, store, and communicate digital information. A computer scientist specializes in the theory of computation and the design of computational systems.</p></blockquote><p>总结来说，计算机科学与技术是设计和使用计算机的理论和实践基础，包括处理、存储和传输数字信息的算法学习。</p><p><strong>计算机科学与技术可以分为科学与技术两部分</strong>，像计算机组成原理、计算机网络、操作系统、数据结构与算法等课程都是在阐述科学的部分，而像 C 语言程序设计、Java 面向对象编程、WEB 网页设计等课程则是在阐述技术部分。</p><p>那么如何学好呢？</p><p>借鉴柏拉图在《理想国》中阐述的教育理念，划分四个学习阶段。</p><p><strong>第一阶段学习一门编程语言以及基础的数据结构与算法知识</strong>。编程语言选择主流的即可，比如 C、Java、Python 都是可以的。编程语言不需要学习的有多么地深入，比如 Java 基本数据类型以及基本的操作、条件分支语句、循环语句、类与对象即可；C 语言或 Python 语言类似。在此阶段不需要把编程语言学习的面面俱到，最重要的是为后面的数据结构与算法的学习打下一定的基础。</p><p>之后，就可以开始学习基础的数据结构与算法知识。在学习此阶段时一定要利用前面所学的编程语言，将学习到的数据结构、算法等实现一遍，这样不仅能够对编程语言有更深入地理解，同时能够对数据结构与算法有更深入地理解。</p><p>经过此阶段的学习，已经具备解决一些算法题目的能力了，可以尝试去一些算法网站去刷题。注意解决刷算法题是一个长期的学习任务，第一阶段结束后就可以尝试每周去刷一道有难度的题目，可以到欧拉计划 (Project Euler) 上找，也可以到 LeetCode 上找，养成用程序的思维来解决问题的习惯。</p><p><strong>第二阶段学习操作系统相关的知识。</strong>这里的操作系统不仅指要学习的计算机操作系统专业课程，同时还要学习并发编程相关的知识。学习计算机操作系统时重点学习操作系统的内存管理、进程线程管理等理论知识，同时结合自己所学习的编程语言来进行相关实践，比如可以同步学习 Java 并发编程、JVM 等知识。</p><p>此阶段的学习至关重要，为以后的学习工作打下扎实的理论和实践基础。</p><p><strong>第三阶段学习计算机网络相关的知识。</strong>同操作系统知识的学习一样，不仅要学习计算机网络专业课，同时还要理论结合实践，去学习 HttpClient 等网络框架技术来进行理论和实践的结合。</p><p>在此阶段的学习过程中，如果时间充裕的话，可以尝试去学习一些微服务、分布式等相关的知识，也可以去学习 WEB 开发、gRPC、Netty、Thrift 等相关知识，这些都和并发编程、网络有密不可分的关系。</p><p>此阶段的学习具备网络开发的能力，可以试着开发一些网络应用。</p><p><strong>第四阶段学习数据库相关知识，同时补充学习一些其他编程知识</strong>，比如汇编语言等。数据库的学习以 MySQL 为主，学习基本的 SQL 操作、SQL 优化以及 InnoDB 存储引擎。</p><p>以上的学习内容是非常充实的学习之旅，当然由于学习的内容比较多，且比较深入，对大家的自学能力有比较高的要求。不过，无论怎样，如果大家能够坚持学习下来，肯定会有很大的收获。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;什么是计算机科学与技术？&lt;/p&gt;
&lt;p&gt;百度百科：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;计算机科学与技术是研究计算机的设计与制造，并利用计算机进行有关的信息表示、收发、存储、处理、控制等的理论方法和技术的学科。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="学科概念" scheme="http://yoursite.com/tags/%E5%AD%A6%E7%A7%91%E6%A6%82%E5%BF%B5/"/>
    
  </entry>
  
  <entry>
    <title>故宫博物馆</title>
    <link href="http://yoursite.com/2020/04/11/%E6%95%85%E5%AE%AB%E5%8D%9A%E7%89%A9%E9%A6%86/"/>
    <id>http://yoursite.com/2020/04/11/%E6%95%85%E5%AE%AB%E5%8D%9A%E7%89%A9%E9%A6%86/</id>
    <published>2020-04-11T06:55:50.000Z</published>
    <updated>2020-06-22T15:13:50.837Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>一款线上的故宫博物馆全景。<a id="more"></a></p><p><a href=" http://t.cn/RXnGc1e " rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一款线上的故宫博物馆全景。
    
    </summary>
    
    
      <category term="博物馆" scheme="http://yoursite.com/categories/%E5%8D%9A%E7%89%A9%E9%A6%86/"/>
    
    
      <category term="虚拟体验" scheme="http://yoursite.com/tags/%E8%99%9A%E6%8B%9F%E4%BD%93%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>电脑博物馆</title>
    <link href="http://yoursite.com/2020/04/11/%E7%94%B5%E8%84%91%E5%8D%9A%E7%89%A9%E9%A6%86/"/>
    <id>http://yoursite.com/2020/04/11/%E7%94%B5%E8%84%91%E5%8D%9A%E7%89%A9%E9%A6%86/</id>
    <published>2020-04-11T06:49:35.000Z</published>
    <updated>2020-06-22T15:14:04.811Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>当你用着最新的电脑，有没有想着感受一下上古时代的电脑，去体验一下那即将改变人类生活方式的10101000古董级电脑。<a id="more"></a></p><p>现在推荐的一个网站是配合知乎专栏,古董电脑室建设的在线电脑模拟器网站，希望能够以一种更直观的方式展示历史上著名的电脑平台的特性。针对中文读者还加入了许多中国市场上独有的硬件和软件平台，包括 UCDOS、文曲星电子词典、小霸王学习机、中华学习机等。</p><p>快去体验一下吧。</p><p><a href="http://www.dnbwg.com/" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;当你用着最新的电脑，有没有想着感受一下上古时代的电脑，去体验一下那即将改变人类生活方式的10101000古董级电脑。
    
    </summary>
    
    
      <category term="博物馆" scheme="http://yoursite.com/categories/%E5%8D%9A%E7%89%A9%E9%A6%86/"/>
    
    
      <category term="有趣的" scheme="http://yoursite.com/tags/%E6%9C%89%E8%B6%A3%E7%9A%84/"/>
    
  </entry>
  
  <entry>
    <title>自由钢琴</title>
    <link href="http://yoursite.com/2020/04/11/%E8%87%AA%E7%94%B1%E9%92%A2%E7%90%B4/"/>
    <id>http://yoursite.com/2020/04/11/%E8%87%AA%E7%94%B1%E9%92%A2%E7%90%B4/</id>
    <published>2020-04-11T06:42:12.000Z</published>
    <updated>2020-06-22T15:13:35.804Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>浏览互联网的过程中，往往都是思维肆意飘荡的时刻，此时某处微小的声音也会激起你内心深处音乐细胞的复苏，相信拥有非凡音乐灵感的你一定想将此情感表达出来。<a id="more"></a></p><p>巧合的是你目前并没有乐器在手，不用慌乱，进入这款在线音乐网站，可能就会帮助到你实现你的情感表达。</p><p><a href=" https://www.autopiano.cn/ " rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;浏览互联网的过程中，往往都是思维肆意飘荡的时刻，此时某处微小的声音也会激起你内心深处音乐细胞的复苏，相信拥有非凡音乐灵感的你一定想将此情感表达出来。
    
    </summary>
    
    
      <category term="音乐" scheme="http://yoursite.com/categories/%E9%9F%B3%E4%B9%90/"/>
    
    
      <category term="有趣的" scheme="http://yoursite.com/tags/%E6%9C%89%E8%B6%A3%E7%9A%84/"/>
    
  </entry>
  
  <entry>
    <title>编程到底难在哪里</title>
    <link href="http://yoursite.com/2020/04/10/%E7%BC%96%E7%A8%8B%E5%88%B0%E5%BA%95%E9%9A%BE%E5%9C%A8%E5%93%AA%E9%87%8C/"/>
    <id>http://yoursite.com/2020/04/10/%E7%BC%96%E7%A8%8B%E5%88%B0%E5%BA%95%E9%9A%BE%E5%9C%A8%E5%93%AA%E9%87%8C/</id>
    <published>2020-04-10T07:03:24.000Z</published>
    <updated>2020-06-22T15:14:28.190Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>知乎上有个问题：编程到底难在哪里？知乎网友 DJ Hitori 的回答获赞无数。<a id="more"></a></p><p>这篇回答并不是讲述在生活中程序员如何买苹果，而是以买苹果为例说明程序员如何解决问题。程序员需要对问题进行透彻的分析，理清其涉及的所有细节，预测可能发生的所有意外与非意外的情况，列出解决方案的所有步骤，以及对解决方案进行尽量全面的测试。而这些正是编程难的地方。任何一点遗漏都会成为 bug，轻则导致挨骂，重则导致经济损失甚至危害安全。</p><h3 id="高赞回答"><a href="#高赞回答" class="headerlink" title="高赞回答"></a>高赞回答</h3><p><strong>普通人：</strong></p><p>我今天要买一斤苹果。</p><p><strong>程序员：</strong></p><p>我今天要买一斤苹果。</p><p>因为我只喜欢红富士苹果，所以我只买红富士苹果。</p><p>我能接受的最高价格是 10 元 / 斤。</p><p>正常情况下一斤苹果用一个袋子能装下，但是为防万一，我会带两个袋子。</p><p>我知道附近的 3 家水果店，所以我会依次访问这 3 家水果店。</p><p>根据上述条件，我设计出以下的买苹果的流程：</p><p><img src="https://i.loli.net/2020/04/10/yTUwouKFQqsnYGc.jpg" alt="1.jpg"></p><p>这个流程怎么样？我来设计一些测试样例，测试一下这个流程。</p><p>测试发现一个问题：</p><p>如果水果店 0 和水果店 1 都有红富士苹果并且价格都低于 10 元 / 斤，而且水果店 1 的价格比水果店 0 更低，那么我希望买水果店 1 的苹果，但我设计的流程会让我买水果店 0 的苹果。</p><p>为了解决这个问题，我应该先询问所有水果店的价格，然后去价格最低的那一家买苹果。</p><p>经过修改，我重新设计出以下的买苹果的流程：</p><p><img src="https://i.loli.net/2020/04/10/DlUaVeLhJBAW5fv.jpg" alt="2.jpg"></p><p>现在这个流程是不是完美了呢？不是，我还能发现很多问题。</p><p>如果 3 家水果店都有红富士苹果但都不到一斤，但是三家店加起来能达到一斤，那么我不应该结束流程回家，而是应该把三家店的红富士苹果都买下来。</p><p>如果我向水果店询问价格的时候这家店还有红富士苹果，但我询问完所有水果店的价格后这家店的红富士苹果卖完了，那么我的流程会让我试图处理不存在的红富士苹果。</p><p>我走路的过程中可能会遇到突发事件，比如发现了新的水果店，比如袋子破掉了苹果掉一地，对于这些情况我的流程都无法进行处理。</p><p>啊问题太多了我懒得再改流程了。我还是去 X 宝买吧。<br>那么接下来我要设计一个在 X 宝买红富士苹果的流程……</p><p>文章来源：<a href="https://www.zhihu.com/answer/141334678" rel="external nofollow noopener noreferrer"  style="text-decoration:none;" target="_blank">传送门</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;知乎上有个问题：编程到底难在哪里？知乎网友 DJ Hitori 的回答获赞无数。
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="编程" scheme="http://yoursite.com/tags/%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>window使用问题解决方案</title>
    <link href="http://yoursite.com/2020/04/10/window%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://yoursite.com/2020/04/10/window%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2020-04-10T03:36:16.000Z</published>
    <updated>2021-04-16T23:37:14.189Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="一、护眼模式的开启和关闭"><a href="#一、护眼模式的开启和关闭" class="headerlink" title="一、护眼模式的开启和关闭"></a>一、护眼模式的开启和关闭</h3><p>﻿1.使用 <strong>Win + R</strong> 组合快捷键，打开“运行”，然后键入打开注册表命令<strong>regedit</strong>，按回车键确认打开。<a id="more"></a></p><p>2.打开Win10注册表之后，依次在左侧树状菜单中展开：<code>HKEY_CURRENT_USER\Control Panel\Colors</code>，然后再右侧找到Windows值，并双击打开。</p><p>3.双击Windows，打开编辑字符串窗口，将的<strong>255 255 255</strong>(默认是白色背景)三组颜色数值改成<strong>202 234 206</strong>(淡绿色)，完成后，点击下方的“确定”保存。</p><p>4.继续找到注册表的路径：<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\</code></p><p><code>CurrentVersion\Themes\DefaultColors\Standard</code>。</p><p>5.同样再在右侧找到Windows双击打开，将默认的数据值 <strong>ffffff</strong> 改成 <strong>caeace</strong> 完成后，点击下方的确定保存。之后重启就会变成淡绿色的护眼状态。</p><blockquote><p>备注：想要恢复怎么办呢。其实很简单。将你修改的202 234 206变为255 255 255。然后将caeace 改为ffffff。重启一下，就可以变成原来的白色背景了。</p></blockquote><h3 id="二、端口被占用"><a href="#二、端口被占用" class="headerlink" title="二、端口被占用"></a>二、端口被占用</h3><p>1.开始–&gt;运行–&gt;cmd；或者是window+R组合键，调出命令窗口 </p><p>2.输入命令：netstat -ano， 列出所有端口已占用的情况</p><p>3.输入命令：netstat -aon|findstr “1001”，查看被占用端口1001对应的PID4</p><p>4.输入命令：tasklist|findstr “4”，回车，查看是哪个进程或者程序占用了1001端口，结果是：svchost.exe ；或者打开任务管理器，切换到进程选项卡，在PID一列查看4对应的进程</p><blockquote><p>如果看不到PID这一列，右键点击选择列，勾选pid，点击确定</p></blockquote><p>5.输入命令： taskkill /f /t /im tasklist.exe ；或者在任务管理器结束pid为4的进程</p><h3 id="三、删除文件提示正在被另一程序占用"><a href="#三、删除文件提示正在被另一程序占用" class="headerlink" title="三、删除文件提示正在被另一程序占用"></a>三、删除文件提示正在被另一程序占用</h3><p>1.打开任务管理器，切换到性能选项卡，点击“打开资源监视器”</p><p>2.在cpu选项卡下找到关联的句柄搜索框</p><p>3.输入要删除文件的文件名，看到新出现的程序，右键点击”结束进程”</p><p>4.重新删除文件</p><h3 id="四、生成文件夹树目录"><a href="#四、生成文件夹树目录" class="headerlink" title="四、生成文件夹树目录"></a>四、生成文件夹树目录</h3><ul><li><p>命令窗口模式</p><ul><li><p>进入文件夹，打开命令窗口</p></li><li><p>输入命令： tree  /f &gt;tree.txt 生成包含当前文件夹及子文件夹目录的文件tree.txt</p><blockquote><p>“.txt”也可以写成”.docx”,”.doc”,”.xlsx”,”.xls”,”.md”结尾生成对应的文件</p></blockquote></li></ul></li><li><p>bat脚本模式</p><ul><li>新建文本文档，输入tree  /f &gt;tree.txt </li><li>修改后缀名为.bat</li><li>将修改后的文件拖入需要生成目录的文件夹下，双击运行脚本</li></ul></li></ul><h3 id="五、命令行窗口打开方式"><a href="#五、命令行窗口打开方式" class="headerlink" title="五、命令行窗口打开方式"></a>五、命令行窗口打开方式</h3><ul><li>全局<ul><li><code>Win</code> + <code>R</code>打开运行，输入<code>cmd</code>，然后按下回车键即可。</li><li><code>Win</code> + <code>R</code>打开运行，输入<code>powershell</code>，然后按下回车键即可。</li><li><code>Win</code> + <code>X</code>或开始菜单按钮右键打开 <code>Windows PowerShell</code></li></ul></li><li>指定目录<ul><li>通过 <code>cd</code> 命令进入指定目录。</li><li>资源管理器打开目录，在地址栏输入 <code>cmd</code> 回车键即可</li><li>按下 <code>Shift</code> 键的同时鼠标右键该目录空白处可选择打开 <code>Windows PowerShell</code></li></ul></li></ul><h3 id="六、IE浏览器打不开网页原因与解决方案"><a href="#六、IE浏览器打不开网页原因与解决方案" class="headerlink" title="六、IE浏览器打不开网页原因与解决方案"></a>六、IE浏览器打不开网页原因与解决方案</h3><ul><li>原因<ul><li>设置问题</li><li>浏览器程序中个别程序被误删</li></ul></li><li>解决方案<ul><li>打开控制面板</li><li>点击网络和Internet</li><li>点击管理浏览器加载项</li><li>点击高级，在重置Internet Explorer设置后面点击重置</li></ul></li></ul><h3 id="七、Windows10系统电脑开机出现-Fixing（E）Stage-1"><a href="#七、Windows10系统电脑开机出现-Fixing（E）Stage-1" class="headerlink" title="七、Windows10系统电脑开机出现 Fixing（E）Stage 1"></a>七、Windows10系统电脑开机出现 Fixing（E）Stage 1</h3><ul><li><p>原因</p><ul><li>Windows10 开机磁盘自检，这样的情况是因为 Windows10 发现磁盘驱动器有文件方面的问题或错误</li></ul></li><li><p>解决方案</p><ul><li><p>手动检查</p><ul><li>选择报错盘右键点击属性，选择工具，手动选择检查驱动器中当前文件系统的错误</li></ul></li></ul></li></ul><ul><li><p>以管理员身份实现禁止磁盘自检和实现命令行系统扫描，检查问题，并自动修复</p><ul><li><p>开始 - 运行 - 输入<code>cmd</code>进入命令行窗口 <code>chkntfs /x</code> 后面加盘符, 比如禁止E盘开机自检就输入 <code>chkntfs /x e: chkntfs /t:0</code></p></li><li><p>最好把每个盘都禁止开机自检，重启电脑，进系统的速度会快些。运行下执行 <code>chkntfs /x c: d: e: f:</code>即可 (注意有空格)，但之后如果你自己手动执行了磁盘扫描后，必须再次执行命令才能重新起到禁止磁盘自动扫描的效果。</p><blockquote><p>注：chkntfs 的具体用法，可执行 chkntfs /？</p></blockquote></li></ul></li><li><p>使用命令行实现系统扫描，命令行：<code>sfc /scannow</code></p></li><li><p>注册表禁止系统开机自检</p><ul><li>开始 - 运行 - 输入<code>regedit</code>打开注册表编辑器，进入<code>计算机 \ HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager</code>，将数值名称<code>BootExecute</code> 里面的数值数据 <code>autocheck autochk *</code>删除，f5 刷新，然后确定重启试试。</li></ul></li><li><p>BIOS设置跳过开机自检</p><ul><li>开机不停按<code>F2</code>键进入 BIOS，进入高级配置页面（Advanced Setup Page）, 找到 Quick Boot 项， 设置为 Enabled. 按 F10 回车保存再开机就会跳过自检直接进系统了。</li></ul></li></ul><h3 id="八、删除服务"><a href="#八、删除服务" class="headerlink" title="八、删除服务"></a>八、删除服务</h3><p>有时候软件被安装成了服务，但是如何删除无效的服务，这时候就不是普通用户就能删除了，这属于操作系统管理级别了，需要使用管理命令了。</p><p>1.打开的系统服务窗口，找到需要删除的服务的名称</p><p>2.用管理员的身份运行 cmd，打开 cmd 窗口，输入 sc delete MySQL命令，提示删除服务成功</p><p>3.再次在系统服务窗口确认服务是否删除，发现已经删除</p><h3 id="九、windows-上拔掉-U-盘或移动硬盘时，弹出：该设备正在使用中，请关闭可能使用该设备的所有程序或窗口，然后重试。"><a href="#九、windows-上拔掉-U-盘或移动硬盘时，弹出：该设备正在使用中，请关闭可能使用该设备的所有程序或窗口，然后重试。" class="headerlink" title="九、windows 上拔掉 U 盘或移动硬盘时，弹出：该设备正在使用中，请关闭可能使用该设备的所有程序或窗口，然后重试。"></a>九、windows 上拔掉 U 盘或移动硬盘时，弹出：该设备正在使用中，请关闭可能使用该设备的所有程序或窗口，然后重试。</h3><p>一般从电脑上取下硬盘或U盘需要两步：1.先在电脑上点弹出 Device，2.弹出 Device 提示成功后，在物理插拔硬盘或 U 盘设备即可。</p><p>但是有时在点弹出 Device时，提示：该设备正在使用中，请关闭可能使用该设备的所有程序或窗口，然后重试。你感觉已经关闭了和挂在移动硬盘或U盘所有的相关程序，如何才能安装的取下硬盘或U盘，强行拔也不是不可以，但很容易导致：1.硬盘或U盘的数据丢失；2.硬盘或U盘因为强行插拔导致设备损坏。</p><p>使用HotSwap软件，该软件很小，只有几百 KB。<a href="https://www.appinn.com/hotswap-for-windows/" target="_blank" rel="noopener">HotSwap</a> 的作用和在 Windows 设备管理器中删除设备是一样的，但它有一个核心功能：在设备热插拔之前，确保将所有数据都完整的写入到磁盘上。然后，强制弹出设备。</p><p>具体使用步骤如下：</p><p>1.下载安装 HostSwap 软件，在显示隐藏的图标里会发现图标<a href="http://mt-naka.com/hotswap/index_enu.htm" target="_blank" rel="noopener">官网下载</a></p><p>2.在该图标上鼠标右键，然后在设备类型选项卡处，把：可移动磁盘设备和安全移动设备勾选上</p><p>3.此时鼠标左键改图标，然后鼠标点击：<code>安全热插拔 \ Device\...</code>，提示：安全移除热插拔设备</p><p>4、此时再点击弹出 Device，就会提示：安全地移除硬件</p><p>5、最后就可以大胆放心的插拔你的移动硬盘或U盘设备了</p><h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">explorer.exe ::&#123;20D04FE0-3AEA-1069-A2D8-08002B30309D&#125;//我的电脑</span><br><span class="line">explorer.exe ::&#123;208D2C60-3AEA-1069-A2D7-08002B30309D&#125;//网上邻居</span><br><span class="line">explorer.exe ::&#123;645FF040-5081-101B-9F08-00AA002F954E&#125;//回收站</span><br></pre></td></tr></table></figure><h3 id="快捷键-win10系统"><a href="#快捷键-win10系统" class="headerlink" title="快捷键(win10系统)"></a>快捷键(win10系统)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Win+A&#x2F;&#x2F;打开通知</span><br><span class="line">Win+B&#x2F;&#x2F;悬浮显示隐藏的图标</span><br><span class="line">Win+C&#x2F;&#x2F;打开Cortana</span><br><span class="line">Win+D   &#x2F;&#x2F;显示桌面，第二次键击恢复桌面</span><br><span class="line">Win+E&#x2F;&#x2F;打开我的电脑、资源管理器</span><br><span class="line">Win+F&#x2F;&#x2F;打开反馈中心</span><br><span class="line">Win+G&#x2F;&#x2F;打开屏幕录制</span><br><span class="line">Win+H&#x2F;&#x2F;打开听写辅助输入</span><br><span class="line">Win+I&#x2F;&#x2F;打开windows设置栏</span><br><span class="line">Win+J</span><br><span class="line">Win+K&#x2F;&#x2F;打开连接</span><br><span class="line">Win+L&#x2F;&#x2F;锁住电脑或切换用户</span><br><span class="line">Win+M&#x2F;&#x2F;最小化所有窗口</span><br><span class="line">Win+N</span><br><span class="line">Win+O&#x2F;&#x2F;禁用屏幕翻转</span><br><span class="line">Win+P&#x2F;&#x2F;投影设置</span><br><span class="line">Win+Q&#x2F;&#x2F;打开搜索栏</span><br><span class="line">Win+R &#x2F;&#x2F;打开“运行”对话框</span><br><span class="line">Win+S&#x2F;&#x2F;&#x2F;&#x2F;打开搜索栏</span><br><span class="line">Win+T&#x2F;&#x2F;切换任务栏上的程序</span><br><span class="line">Win+U&#x2F;&#x2F;打开轻松使用中心</span><br><span class="line">Win+V&#x2F;&#x2F;打开剪切板</span><br><span class="line">Win+W&#x2F;&#x2F;打开Whiteborad和全屏截图</span><br><span class="line">Win+X&#x2F;&#x2F;打开快捷菜单</span><br><span class="line">win+Y</span><br><span class="line">win+Y</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;一、护眼模式的开启和关闭&quot;&gt;&lt;a href=&quot;#一、护眼模式的开启和关闭&quot; class=&quot;headerlink&quot; title=&quot;一、护眼模式的开启和关闭&quot;&gt;&lt;/a&gt;一、护眼模式的开启和关闭&lt;/h3&gt;&lt;p&gt;﻿1.使用 &lt;strong&gt;Win + R&lt;/strong&gt; 组合快捷键，打开“运行”，然后键入打开注册表命令&lt;strong&gt;regedit&lt;/strong&gt;，按回车键确认打开。
    
    </summary>
    
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="开发环境" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    
  </entry>
  
  <entry>
    <title>幸存者偏差</title>
    <link href="http://yoursite.com/2020/04/09/%E5%B9%B8%E5%AD%98%E8%80%85%E5%81%8F%E5%B7%AE/"/>
    <id>http://yoursite.com/2020/04/09/%E5%B9%B8%E5%AD%98%E8%80%85%E5%81%8F%E5%B7%AE/</id>
    <published>2020-04-09T15:23:48.000Z</published>
    <updated>2020-04-11T07:03:02.668Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="幸存者偏差"><a href="#幸存者偏差" class="headerlink" title="幸存者偏差"></a>幸存者偏差</h2><h3 id="一、-简单了解幸存者偏差概念"><a href="#一、-简单了解幸存者偏差概念" class="headerlink" title="一、 简单了解幸存者偏差概念"></a>一、 简单了解幸存者偏差概念</h3><p> 幸存者偏差（Survivor bias），另译为 “生存者偏差” 或 “存活者偏差”，是一种常见的逻辑谬误。指的是<strong>只能看到经过某种筛选而产生的结果，而没有意识到筛选的过程，因此忽略了被筛选掉的关键信息。</strong> <a id="more"></a></p><p>是不是有点点懵逼，下面通过故事来理解一下这个概念。</p><p><img src="https://i.loli.net/2020/04/10/uW64gLy7jDE31Xd.jpg" alt="640.jpg"></p><p>幸存者偏差最早来源于第二次世界大战期间，美国哥伦比亚大学统计学亚伯拉罕·沃德教授接受美国海军要求，运用他在统计方面的专业知识给出关于“飞机应该如何加强防护，才能降低被炮火击落的几率”的建议。</p><p>通过统计发现主要受损部位集中在机翼，所以结论是应当减少机腹的装甲加强机翼的装甲？这个结论显然是可笑的，造成这种偏差的原因是机腹中弹的灰机大多数都坠毁了，统计结论产生了偏差，这个偏差被命名为“幸存者偏差”。</p><p>现在对于概念是不是有一个直观的看法？没有？</p><p>那好，坐好小板凳，我们再来看看下面的栗子~</p><h3 id="二、-理论结合实际解释幸存者偏差"><a href="#二、-理论结合实际解释幸存者偏差" class="headerlink" title="二、 理论结合实际解释幸存者偏差"></a>二、 理论结合实际解释幸存者偏差</h3><blockquote><p>一名记者来到火车站台上，随机询问：“请问你买到火车票了吗？”<br>一位大妈微微一愣，回答：“买到了”<br>记者又转向一位精瘦精瘦的年轻人，问：“请问你买到火车票了吗？”<br>年轻人回答：“买到了”<br>随后记者又问了5个人，大家都回答：“买到了”<br>最后记者对着镜头说：“今年虽然火车票难买，但是通过采访我们发现，大家都买到了火车票，现在正满怀希望地赶回家乡，过个团圆年！”</p></blockquote><p>还没买到票的朋友是不是会问候记者，自己是被代表了吗?哈哈哈~</p><p><img src="https://i.loli.net/2020/04/10/EC3NpDj2siRVW8b.jpg" alt="813494-98497f095a147532.jpg"></p><p> <strong>当我们分析问题所依赖信息全部或者大部分来自于“显著的信息”，较少利用“不显著的信息”甚至忽略“沉默的信息”，得出的结论与事实情况就可能存在巨大偏差。</strong> </p><h3 id="三、-了解幸存者偏差的重要性"><a href="#三、-了解幸存者偏差的重要性" class="headerlink" title="三、 了解幸存者偏差的重要性"></a>三、 了解幸存者偏差的重要性</h3><p>幸存者偏差实质上是一个思维陷阱，如果仅仅只对人生中的一些无关紧要的事情产生影响，似乎就无需过多关注，但现实中，其实这种<strong>幸存者偏差明显更偏好于我们面临的重大人生选择以及工作决策</strong>。</p><p>这些情况，如果被幸存者偏差这个陷阱蒙蔽了，做出了错误的决策，那很有可能会抱憾终身，毕竟人生有时选择是大于努力的。</p><p>所以了解这个概念，会让我们在遇到重大决策前， 能够全面客观冷静的去分析各个可能，不会出现太大的失误，这对于我们来说是真的很重要。</p><p>相信很多人都听过读书无用论，很多老板都是小学学历，而实际情况是，这些能出人头地的“小学老板”是非常少见的，更多的还在底层打工呢。</p><p>但是这些底层打工的人不会跳出来的，所以我们看到的永远是那些被过分渲染的“小学老板”，也因此会导致我们产生了上学没用这样的错误印象。这也会对一些人的人生选择产生误导，到时候就会更加悔恨当初的决定是多么傻。</p><h3 id="四、如何避免幸存者偏差"><a href="#四、如何避免幸存者偏差" class="headerlink" title="四、如何避免幸存者偏差"></a>四、如何避免幸存者偏差</h3><p>细想一下，<strong>出现幸存者偏差，不过是以偏概全，忽视了别的信息</strong>，正如我们想一个问题时，陷进死胡同就会放弃，却很少会去反过来想想，再推导。</p><p>逆向思考就可以打开我们的新视野，看到别人没有看到的东西，了解到别人忽略掉的问题。</p><p>我们知道很多摄影者在拍集体照时总是先数“3、2、1”，可是尽管我们都尽量睁大了眼睛，但总会有些人在数到1的时候坚持不住眨了眼，最后出来的照片就会有闭眼的情况，不管何时看到，都是心塞塞呀~</p><p>但是,我们也知道总会有那么一小搓神奇的人，他们可以坚持比我们大多数人长的时间不用眨眼，那他们在拍照时不闭眼更是小case了，这个其实因人而异的，而且他们是少数，并非多数，不具代表性，那如果要解决这个问题，应该怎么做呢？</p><p>后来有个人出了个主意，大家将信将疑，甚至还觉得有点怪异，可是照片拍出来以后一看，果然一个闭眼的都没有，先停一下，别往下刷，你试试你能想出好主意吗？</p><hr><p>⏫</p><p>多思考一下呀呀呀<del>~</del></p><p>⏬</p><hr><p>看你的思考是不是和我的一样，我们来回顾一下正常的思考路径：</p><p>“使大家在按下快门前不眨眼”是我们的研究对象；</p><p>我们先按正常思路想是不是会局限在如何睁大眼睛以保证拍的那刻眼睛没有闭上，这时估计可能就会出现各种各样奇葩的撑住眼皮的方法了，但是都不科学。</p><p>因为人的眼睛睁得久了就是需要通过眨眼来补充水分，这是所谓的天性嘛，就像打呵欠、打喷嚏，你说你能控制么？而且撑眼皮行不通的，拍出来也不好看呀。</p><p>针对这一问题，我们从正面想就是：如何一直保持睁着眼睛；</p><p>从反面想那就是不长时间保持眼睛睁开，也就是闭上眼睛。</p><p> 按照这个反面思路，答案就出来了：<strong>新办法是让大家都闭上眼睛，喊“3、2、1”后再一起睁眼。那么拍出来的照片大家就都是睁着眼睛的。</strong></p><p>你说这个逆思维是不是用的很妙。它针对的无论是否有特异功能可以长时间不闭眼还是一帮普通人隔几秒钟就要闭下眼补充水分的人，都是一个很好的解决方案，考虑的很全面，也是通过逆思维方式完美避开了幸存者偏差这个思维陷阱。</p><p>这样我们也就不会通过<strong>一小部分人可以长时间不闭眼</strong>而得出<strong>人长时间不闭眼是可以的</strong>这种错误结论，因为它没考虑到其他做不到的人呀，那些做不到的就属于“沉默的信息”。</p><p>希望此文对你有帮助。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;幸存者偏差&quot;&gt;&lt;a href=&quot;#幸存者偏差&quot; class=&quot;headerlink&quot; title=&quot;幸存者偏差&quot;&gt;&lt;/a&gt;幸存者偏差&lt;/h2&gt;&lt;h3 id=&quot;一、-简单了解幸存者偏差概念&quot;&gt;&lt;a href=&quot;#一、-简单了解幸存者偏差概念&quot; class=&quot;headerlink&quot; title=&quot;一、 简单了解幸存者偏差概念&quot;&gt;&lt;/a&gt;一、 简单了解幸存者偏差概念&lt;/h3&gt;&lt;p&gt; 幸存者偏差（Survivor bias），另译为 “生存者偏差” 或 “存活者偏差”，是一种常见的逻辑谬误。指的是&lt;strong&gt;只能看到经过某种筛选而产生的结果，而没有意识到筛选的过程，因此忽略了被筛选掉的关键信息。&lt;/strong&gt;
    
    </summary>
    
    
      <category term="思维" scheme="http://yoursite.com/categories/%E6%80%9D%E7%BB%B4/"/>
    
    
      <category term="认知偏差" scheme="http://yoursite.com/tags/%E8%AE%A4%E7%9F%A5%E5%81%8F%E5%B7%AE/"/>
    
  </entry>
  
</feed>
